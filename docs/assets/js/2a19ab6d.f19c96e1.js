"use strict";(self.webpackChunkadapty_docs=self.webpackChunkadapty_docs||[]).push([[7089],{11470:(e,t,r)=>{r.d(t,{A:()=>w});var s=r(96540),n=r(34164),a=r(23104),l=r(56347),i=r(205),c=r(57485),d=r(31682),o=r(70679);function u(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:t,children:r}=e;return(0,s.useMemo)((()=>{const e=t??function(e){return u(e).map((e=>{let{props:{value:t,label:r,attributes:s,default:n}}=e;return{value:t,label:r,attributes:s,default:n}}))}(r);return function(e){const t=(0,d.X)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,r])}function p(e){let{value:t,tabValues:r}=e;return r.some((e=>e.value===t))}function f(e){let{queryString:t=!1,groupId:r}=e;const n=(0,l.W6)(),a=function(e){let{queryString:t=!1,groupId:r}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:t,groupId:r});return[(0,c.aZ)(a),(0,s.useCallback)((e=>{if(!a)return;const t=new URLSearchParams(n.location.search);t.set(a,e),n.replace({...n.location,search:t.toString()})}),[a,n])]}function y(e){const{defaultValue:t,queryString:r=!1,groupId:n}=e,a=h(e),[l,c]=(0,s.useState)((()=>function(e){let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const s=r.find((e=>e.default))??r[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:t,tabValues:a}))),[d,u]=f({queryString:r,groupId:n}),[y,m]=function(e){let{groupId:t}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(t),[n,a]=(0,o.Dv)(r);return[n,(0,s.useCallback)((e=>{r&&a.set(e)}),[r,a])]}({groupId:n}),x=(()=>{const e=d??y;return p({value:e,tabValues:a})?e:null})();(0,i.A)((()=>{x&&c(x)}),[x]);return{selectedValue:l,selectValue:(0,s.useCallback)((e=>{if(!p({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);c(e),u(e),m(e)}),[u,m,a]),tabValues:a}}var m=r(92303);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var g=r(74848);function j(e){let{className:t,block:r,selectedValue:s,selectValue:l,tabValues:i}=e;const c=[],{blockElementScrollPositionUntilNextRender:d}=(0,a.a_)(),o=e=>{const t=e.currentTarget,r=c.indexOf(t),n=i[r].value;n!==s&&(d(t),l(n))},u=e=>{let t=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":{const r=c.indexOf(e.currentTarget)+1;t=c[r]??c[0];break}case"ArrowLeft":{const r=c.indexOf(e.currentTarget)-1;t=c[r]??c[c.length-1];break}}t?.focus()};return(0,g.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,n.A)("tabs",{"tabs--block":r},t),children:i.map((e=>{let{value:t,label:r,attributes:a}=e;return(0,g.jsx)("li",{role:"tab",tabIndex:s===t?0:-1,"aria-selected":s===t,ref:e=>c.push(e),onKeyDown:u,onClick:o,...a,className:(0,n.A)("tabs__item",x.tabItem,a?.className,{"tabs__item--active":s===t}),children:r??t},t)}))})}function b(e){let{lazy:t,children:r,selectedValue:n}=e;const a=(Array.isArray(r)?r:[r]).filter(Boolean);if(t){const e=a.find((e=>e.props.value===n));return e?(0,s.cloneElement)(e,{className:"margin-top--md"}):null}return(0,g.jsx)("div",{className:"margin-top--md",children:a.map(((e,t)=>(0,s.cloneElement)(e,{key:t,hidden:e.props.value!==n})))})}function A(e){const t=y(e);return(0,g.jsxs)("div",{className:(0,n.A)("tabs-container",x.tabList),children:[(0,g.jsx)(j,{...t,...e}),(0,g.jsx)(b,{...t,...e})]})}function w(e){const t=(0,m.A)();return(0,g.jsx)(A,{...e,children:u(e.children)},String(t))}},15448:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>o,contentTitle:()=>c,default:()=>p,frontMatter:()=>i,metadata:()=>d,toc:()=>u});var s=r(74848),n=r(28453),a=(r(26393),r(11470)),l=r(19365);r(97808);const i={title:"Make purchases in mobile app",description:"Guide on handling in-app purchases and subscriptions using Adapty.",metadataTitle:"Handling In-App Purchases in Adapty | Adapty Docs"},c=void 0,d={id:"making-purchases",title:"Make purchases in mobile app",description:"Guide on handling in-app purchases and subscriptions using Adapty.",source:"@site/versioned_docs/version-3.0/making-purchases.md",sourceDirName:".",slug:"/making-purchases",permalink:"/test_assignment_adapty/docs/making-purchases",draft:!1,unlisted:!1,tags:[],version:"3.0",frontMatter:{title:"Make purchases in mobile app",description:"Guide on handling in-app purchases and subscriptions using Adapty.",metadataTitle:"Handling In-App Purchases in Adapty | Adapty Docs"},sidebar:"tutorialSidebar",previous:{title:"Render paywall designed by remote config",permalink:"/test_assignment_adapty/docs/present-remote-config-paywalls"},next:{title:"Restore purchases in mobile app",permalink:"/test_assignment_adapty/docs/restore-purchase"}},o={},u=[{value:"Make purchase",id:"make-purchase",level:2},{value:"Change subscription when making a purchase",id:"change-subscription-when-making-a-purchase",level:2},{value:"In-app purchases from the App Store",id:"in-app-purchases-from-the-app-store",level:2},{value:"Redeem Offer Code in iOS",id:"redeem-offer-code-in-ios",level:2}];function h(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.p,{children:["Displaying paywalls within your mobile app is an essential step in offering users access to premium content or services. However, simply presenting these paywalls is enough to support purchases only if you use ",(0,s.jsx)(t.a,{href:"adapty-paywall-builder",children:"Paywall Builder"})," to customize your paywalls."]}),"\n",(0,s.jsxs)(t.p,{children:["If you don't use the Paywall Builder, you must use a separate method called ",(0,s.jsx)(t.code,{children:".makePurchase()"})," to complete a purchase and unlock the desired content. This method serves as the gateway for users to engage with the paywalls and proceed with their desired transactions."]}),"\n",(0,s.jsx)(t.p,{children:"If your paywall has an active promotional offer for the product a user is trying to buy, Adapty will automatically apply it at the time of purchase."}),"\n",(0,s.jsxs)(t.admonition,{type:"warning",children:[(0,s.jsx)(t.p,{children:"Keep in mind that the introductory offer will be applied automatically only if you use the paywalls set up using the Paywall Builder."}),(0,s.jsxs)(t.p,{children:["In other cases, you'll need to ",(0,s.jsx)(t.a,{href:"fetch-paywalls-and-products#check-intro-offer-eligibility-on-ios",children:"verify the user's eligibility for an introductory offer on iOS"}),".  Skipping this step may result in your app being rejected during release. Moreover, it could lead to charging the full price to users who are eligible for an introductory offer."]})]}),"\n",(0,s.jsxs)(t.p,{children:["Make sure you've ",(0,s.jsx)(t.a,{href:"quickstart",children:"done the initial configuration"})," without skipping a single step. Without it, we can't validate purchases."]}),"\n",(0,s.jsx)(t.h2,{id:"make-purchase",children:"Make purchase"}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsxs)(t.p,{children:["In paywalls built with ",(0,s.jsx)(t.a,{href:"adapty-paywall-builder",children:"Paywall Builder"})," purchases are processed automatically with no additional code. If that's your case \u2014 you can skip this step."]})}),"\n",(0,s.jsxs)(a.A,{groupId:"current-os",queryString:!0,children:[(0,s.jsx)(l.A,{value:"swift",label:"Swift",default:!0,children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-swift",metastring:"showLineNumbers",children:'do {\n    let purchaseResult = try await Adapty.makePurchase(product: product)\n\n    switch purchaseResult {\n        case .userCancelled:\n            // Handle the case where the user canceled the purchase\n        case .pending:\n            // Handle deferred purchases (e.g., the user will pay offline with cash)\n        case let .success(profile, transaction):\n            if profile.accessLevels["YOUR_ACCESS_LEVEL"]?.isActive ?? false {\n            // Grant access to the paid features\n            }\n    }\n} catch {\n    // Handle the error\n}\n'})})}),(0,s.jsx)(l.A,{value:"swift-callback",label:"Swift-Callback",default:!0,children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-swift",metastring:"showLineNumbers",children:'Adapty.makePurchase(product: product) { result in\n    switch result {\n    case let .success(purchaseResult):\n        switch purchaseResult {\n            case .userCancelled:\n                // Handle the case where the user canceled the purchase\n            case .pending:\n                // Handle deferred purchases (e.g., the user will pay offline with cash)\n            case let .success(profile, transaction):\n                if profile.accessLevels["YOUR_ACCESS_LEVEL"]?.isActive ?? false {\n                    // Grant access to the paid features\n                }\n        }\n    case let .failure(error):\n        // Handle the error\n    }\n}\n'})})}),(0,s.jsx)(l.A,{value:"kotlin",label:"Kotlin",default:!0,children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-kotlin",metastring:"showLineNumbers",children:'Adapty.makePurchase(activity, product) { result ->\n    when (result) {\n        is AdaptyResult.Success -> {\n            when (val purchaseResult = result.value) {\n                is AdaptyPurchaseResult.Success -> {\n                    val profile = purchaseResult.profile\n                    if (profile.accessLevels["YOUR_ACCESS_LEVEL"]?.isActive == true) {\n                        // Grant access to the paid features\n                    }\n                }\n\n                is AdaptyPurchaseResult.UserCanceled -> {\n                    // Handle the case where the user canceled the purchase\n                }\n\n                is AdaptyPurchaseResult.Pending -> {\n                    // Handle deferred purchases (e.g., the user will pay offline with cash)\n                }\n            }\n        }\n        is AdaptyResult.Error -> {\n            val error = result.error\n            // Handle the error\n        }\n    }\n}\n'})})}),(0,s.jsx)(l.A,{value:"java",label:"Java",default:!0,children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-java",metastring:"showLineNumbers",children:'Adapty.makePurchase(activity, product, result -> {\n    if (result instanceof AdaptyResult.Success) {\n        AdaptyPurchaseResult purchaseResult = ((AdaptyResult.Success<AdaptyPurchaseResult>) result).getValue();\n\n        if (purchaseResult instanceof AdaptyPurchaseResult.Success) {\n            AdaptyProfile profile = ((AdaptyPurchaseResult.Success) purchaseResult).getProfile();\n            AdaptyProfile.AccessLevel premium = profile.getAccessLevels().get("YOUR_ACCESS_LEVEL");\n\n            if (premium != null && premium.isActive()) {\n                // Grant access to the paid features\n            }\n        } else if (purchaseResult instanceof AdaptyPurchaseResult.UserCanceled) {\n            // Handle the case where the user canceled the purchase\n        } else if (purchaseResult instanceof AdaptyPurchaseResult.Pending) {\n            // Handle deferred purchases (e.g., the user will pay offline with cash)\n        }\n    } else if (result instanceof AdaptyResult.Error) {\n        AdaptyError error = ((AdaptyResult.Error) result).getError();\n        // Handle the error\n    }\n});\n'})})}),(0,s.jsxs)(l.A,{value:"flutter",label:"Flutter",default:!0,children:[(0,s.jsx)(t.p,{children:"This snippet is valid for v.2.0 or later."}),(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",metastring:"showLineNumbers",children:"try {\n  final purchaseResult = await Adapty().makePurchase(product: product);\n    switch (purchaseResult) {\n      case AdaptyPurchaseResultSuccess(profile: final profile):\n        if (profile.accessLevels['premium']?.isActive ?? false) {\n          // Grant access to the paid features\n        }\n        break;\n      case AdaptyPurchaseResultPending():\n        break;\n      case AdaptyPurchaseResultUserCancelled():\n        break;\n      default:\n        break;\n    }\n} on AdaptyError catch (adaptyError) {\n    // Handle the error\n} catch (e) {\n    // Handle the error\n}\n"})})]}),(0,s.jsx)(l.A,{value:"unity",label:"Unity",default:!0,children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",metastring:"showLineNumbers",children:"using AdaptySDK;\n\nvoid MakePurchase(AdaptyPaywallProduct product) {\n  Adapty.MakePurchase(product, (result, error) => {\n    switch (result.Type) {\n      case AdaptyPurchaseResultType.Pending:\n        // handle pending purchase\n        break;\n      case AdaptyPurchaseResultType.UserCancelled:\n        // handle purchase cancellation\n        break;\n      case AdaptyPurchaseResultType.Success:\n        var profile = result.Profile;\n        // handle successfull purchase\n        break;\n      default:\n        break;\n    }\n  });\n}\n"})})}),(0,s.jsx)(l.A,{value:"rn",label:"React Native (TS)",default:!0,children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",metastring:"showLineNumbers",children:"try {\n    const purchaseResult = await adapty.makePurchase(product);\n    switch (purchaseResult.type) {\n      case 'success':\n        const isSubscribed = purchaseResult.profile?.accessLevels['YOUR_ACCESS_LEVEL']?.isActive;\n\n        if (isSubscribed) {\n          // Grant access to the paid features\n        }\n        break;\n      case 'user_cancelled':\n        // Handle the case where the user canceled the purchase\n        break;\n      case 'pending':\n        // Handle deferred purchases (e.g., the user will pay offline with cash)\n        break;\n    }\n} catch (error) {\n    // Handle the error\n}\n"})})})]}),"\n",(0,s.jsx)(t.p,{children:"Request parameters:"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Presence"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"Product"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"required"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["An ",(0,s.jsx)(t.a,{href:"sdk-models#adaptypaywallproduct",children:(0,s.jsx)(t.code,{children:"AdaptyPaywallProduct"})})," object retrieved from the paywall."]})]})})]}),"\n",(0,s.jsx)(t.p,{children:"Response parameters:"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Parameter"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"Profile"})}),(0,s.jsxs)(t.td,{children:[(0,s.jsxs)("p",{children:["An ",(0,s.jsx)(t.a,{href:"sdk-models#adaptyprofile",children:"AdaptyProfile"})," object provides comprehensive information about a user's access levels, subscriptions, and non-subscription purchases within the app."]}),(0,s.jsx)("p",{children:"Check the access level status to ascertain whether the user has the required access to the app."})]})]})})]}),"\n",(0,s.jsx)(t.admonition,{type:"warning",children:(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Note:"})," if you're still on Apple's StoreKit version lower than v2.0 and Adapty SDK version lowers than v.2.9.0, you need to provide ",(0,s.jsx)(t.a,{href:"app-store-connection-configuration#step-4-enter-app-store-shared-secret",children:"Apple App Store shared secret"})," instead. This method is currently deprecated by Apple."]})}),"\n",(0,s.jsx)(t.h2,{id:"change-subscription-when-making-a-purchase",children:"Change subscription when making a purchase"}),"\n",(0,s.jsx)(t.p,{children:"When a user opts for a new subscription instead of renewing the current one, the way it works depends on the app store:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"For the App Store, the subscription is automatically updated within the subscription group. If a user purchases a subscription from one group while already having a subscription from another, both subscriptions will be active at the same time."}),"\n",(0,s.jsx)(t.li,{children:"For Google Play, the subscription isn't automatically updated. You'll need to manage the switch in your mobile app code as described below."}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["To replace the subscription with another one in Android, call ",(0,s.jsx)(t.code,{children:".makePurchase()"})," method with the additional parameter:"]}),"\n",(0,s.jsxs)(a.A,{groupId:"current-os",queryString:!0,children:[(0,s.jsxs)(l.A,{value:"kotlin",label:"Kotlin",default:!0,children:[(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-kotlin",metastring:"showLineNumbers",children:"Adapty.makePurchase(activity, product, subscriptionUpdateParams) { result ->\n    when (result) {\n        is AdaptyResult.Success -> {\n            when (val purchaseResult = result.value) {\n                is AdaptyPurchaseResult.Success -> {\n                    val profile = purchaseResult.profile\n\n                    // successful cross-grade\n                }\n\n                is AdaptyPurchaseResult.UserCanceled -> {\n                    // user canceled the purchase flow\n                }\n\n                is AdaptyPurchaseResult.Pending -> {\n                    // the purchase has not been finished yet, e.g. user will pay offline by cash\n                }\n            }\n        }\n        is AdaptyResult.Error -> {\n            val error = result.error\n            // Handle the error\n        }\n    }\n}\n"})}),(0,s.jsx)(t.p,{children:"Additional request parameter:"}),(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Presence"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"subscriptionUpdateParams"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"required"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["an ",(0,s.jsx)(t.a,{href:"sdk-models#adaptysubscriptionupdateparameters",children:(0,s.jsx)(t.code,{children:"AdaptySubscriptionUpdateParameters"})})," object."]})]})})]})]}),(0,s.jsxs)(l.A,{value:"java",label:"Java",default:!0,children:[(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-java",metastring:"showLineNumbers",children:"Adapty.makePurchase(activity, product, subscriptionUpdateParams, result -> {\n    if (result instanceof AdaptyResult.Success) {\n        AdaptyPurchaseResult purchaseResult = ((AdaptyResult.Success<AdaptyPurchaseResult>) result).getValue();\n\n        if (purchaseResult instanceof AdaptyPurchaseResult.Success) {\n            AdaptyProfile profile = ((AdaptyPurchaseResult.Success) purchaseResult).getProfile();\n\n            // successful cross-grade\n        } else if (purchaseResult instanceof AdaptyPurchaseResult.UserCanceled) {\n            // user canceled the purchase flow\n        } else if (purchaseResult instanceof AdaptyPurchaseResult.Pending) {\n            // the purchase has not been finished yet, e.g. user will pay offline by cash\n        }\n    } else if (result instanceof AdaptyResult.Error) {\n        AdaptyError error = ((AdaptyResult.Error) result).getError();\n        // Handle the error\n    }\n});\n"})}),(0,s.jsx)(t.p,{children:"Additional request parameter:"}),(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Presence"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"subscriptionUpdateParams"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"required"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["an ",(0,s.jsx)(t.a,{href:"sdk-models#adaptysubscriptionupdateparameters",children:(0,s.jsx)(t.code,{children:"AdaptySubscriptionUpdateParameters"})})," object."]})]})})]})]}),(0,s.jsxs)(l.A,{value:"flutter",label:"Flutter",default:!0,children:[(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",metastring:"showLineNumbers",children:"try {\n  final result = await adapty.makePurchase(\n    product: product,\n    subscriptionUpdateParams: subscriptionUpdateParams,\n  );\n  \n  // successful cross-grade\n} on AdaptyError catch (adaptyError) {\n  // Handle the error\n} catch (e) {\n  // Handle the error\n}\n"})}),(0,s.jsx)(t.p,{children:"Additional request parameter:"}),(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Presence"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"subscriptionUpdateParams"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"required"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["an ",(0,s.jsx)(t.a,{href:"sdk-models#adaptysubscriptionupdateparameters",children:(0,s.jsx)(t.code,{children:"AdaptySubscriptionUpdateParameters"})})," object."]})]})})]})]}),(0,s.jsxs)(l.A,{value:"unity",label:"Unity",default:!0,children:[(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",metastring:"showLineNumbers",children:"Adapty.MakePurchase(product, subscriptionUpdateParams, (profile, error) => {\n  if(error != null) {\n      // Handle the error\n      return;\n  }\n  \n  // successful cross-grade\n});\n"})}),(0,s.jsx)(t.p,{children:"Additional request parameter:"}),(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Presence"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"subscriptionUpdateParams"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"required"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["an ",(0,s.jsx)(t.a,{href:"sdk-models#adaptysubscriptionupdateparameters",children:(0,s.jsx)(t.code,{children:"AdaptySubscriptionUpdateParameters"})})," object."]})]})})]})]}),(0,s.jsxs)(l.A,{value:"rn",label:"React Native (TS)",default:!0,children:[(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",metastring:"showLineNumbers",children:"try {\n    const purchaseResult = await adapty.makePurchase(product, params);\n    switch (purchaseResult.type) {\n      case 'success':\n        const isSubscribed = purchaseResult.profile?.accessLevels['YOUR_ACCESS_LEVEL']?.isActive;\n\n        if (isSubscribed) {\n          // Grant access to the paid features\n        }\n        break;\n      case 'user_cancelled':\n        // Handle the case where the user canceled the purchase\n        break;\n      case 'pending':\n        // Handle deferred purchases (e.g., the user will pay offline with cash)\n        break;\n    }\n} catch (error) {\n    // Handle the error\n}\n"})}),(0,s.jsx)(t.p,{children:"Additional request parameter:"}),(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Parameter"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Presence"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsx)(t.tbody,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"params"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"required"}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["an object of the ",(0,s.jsx)(t.a,{href:"https://react-native.adapty.io/interfaces/makepurchaseparamsinput",children:(0,s.jsx)(t.code,{children:"MakePurchaseParamsInput"})})," type."]})]})})]})]})]}),"\n",(0,s.jsx)(t.p,{children:"You can read more about subscriptions and proration modes in the Google Developer documentation:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://developer.android.com/google/play/billing/subscriptions#proration",children:"About subscriptions"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://developer.android.com/google/play/billing/subscriptions#proration-recommendations",children:"Recommendations from Google for proration modes"})}),"\n",(0,s.jsxs)(t.li,{children:["Proration mode ",(0,s.jsx)(t.a,{href:"https://developer.android.com/reference/com/android/billingclient/api/BillingFlowParams.ProrationMode#IMMEDIATE_AND_CHARGE_PRORATED_PRICE",children:(0,s.jsx)(t.code,{children:"IMMEDIATE_AND_CHARGE_PRORATED_PRICE"})}),". Note: this method is available only for subscription upgrades. Downgrades are not supported."]}),"\n",(0,s.jsxs)(t.li,{children:["Proration mode ",(0,s.jsx)(t.a,{href:"https://developer.android.com/reference/com/android/billingclient/api/BillingFlowParams.ProrationMode#DEFERRED",children:(0,s.jsx)(t.code,{children:"DEFERRED"})}),". Note: in case of success, ",(0,s.jsx)(t.code,{children:"profile"})," in the callback will be returned as ",(0,s.jsx)(t.code,{children:"null"})," since a real subscription change will occur only when the current subscription's billing period ends."]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"in-app-purchases-from-the-app-store",children:"In-app purchases from the App Store"}),"\n",(0,s.jsx)(t.p,{children:"When a user initiates a purchase in the App Store and the transaction carries over to your app, you have two options:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Process the transaction immediately:"})," Return ",(0,s.jsx)(t.code,{children:"true"})," in ",(0,s.jsx)(t.code,{children:"shouldAddStorePayment"}),". This will trigger the Apple purchase system screen right away."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Store the product object for later processing:"})," Return ",(0,s.jsx)(t.code,{children:"false"})," in ",(0,s.jsx)(t.code,{children:"shouldAddStorePayment"}),", then call ",(0,s.jsx)(t.code,{children:"makePurchase"})," with the stored product later. This may be useful if you need to show something custom to your user before triggering a purchase."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Here\u2019s the complete snippet:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-swift",metastring:'showLineNumbers title="Swift"',children:"final class YourAdaptyDelegateImplementation: AdaptyDelegate {\n    nonisolated func shouldAddStorePayment(for product: AdaptyDeferredProduct) -> Bool {\n        // 1a.\n        // Return `true` to continue the transaction in your app. The Apple purchase system screen will show automatically.\n\n        // 1b.\n        // Store the product object and return `false` to defer or cancel the transaction.\n        false\n    }\n    \n    // 2. Continue the deferred purchase later on by passing the product to `makePurchase` when the timing is appropriate\n    func continueDeferredPurchase() async {\n        let storedProduct: AdaptyDeferredProduct = // get the product object from 1b.\n        do {\n            try await Adapty.makePurchase(product: storedProduct)\n        } catch {\n            // handle the error\n        }\n    }\n}\n"})}),"\n",(0,s.jsx)(t.h2,{id:"redeem-offer-code-in-ios",children:"Redeem Offer Code in iOS"}),"\n",(0,s.jsx)(t.p,{children:"Since iOS 14.0, your users can redeem Offer Codes. Code redemption means using a special code, like a promotional or gift card code, to get free access to content or features in an app or on the App Store. To enable users to redeem offer codes, you can display the offer code redemption sheet by using the appropriate SDK method:"}),"\n",(0,s.jsxs)(a.A,{groupId:"current-os",queryString:!0,children:[(0,s.jsx)(l.A,{value:"swift",label:"Swift",default:!0,children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-swift",metastring:"showLineNumbers",children:"Adapty.presentCodeRedemptionSheet()\n"})})}),(0,s.jsx)(l.A,{value:"flutter",label:"Flutter",default:!0,children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-javascript",metastring:"showLineNumbers",children:"try {\n  await Adapty().presentCodeRedemptionSheet();\n} on AdaptyError catch (adaptyError) {\n  // handle the error\n} catch (e) {\n  // handle the error\n}\n"})})}),(0,s.jsx)(l.A,{value:"unity",label:"Unity",default:!0,children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-csharp",metastring:"showLineNumbers",children:"Adapty.PresentCodeRedemptionSheet((error) => {\n  // handle the error\n});\n"})})}),(0,s.jsx)(l.A,{value:"rn",label:"React Native (TS)",default:!0,children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",metastring:"showLineNumbers",children:"adapty.presentCodeRedemptionSheet();\n"})})})]}),"\n",(0,s.jsxs)(t.admonition,{type:"danger",children:[(0,s.jsx)(t.p,{children:"Based on our observations, the Offer Code Redemption sheet in some apps may not work reliably. We recommend redirecting the user directly to the App Store."}),(0,s.jsxs)(t.p,{children:["In order to do this, you need to open the url of the following format:\n",(0,s.jsx)(t.code,{children:"https://apps.apple.com/redeem?ctx=offercodes&id={apple_app_id}&code={code}"})]})]})]})}function p(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},19365:(e,t,r)=>{r.d(t,{A:()=>l});r(96540);var s=r(34164);const n={tabItem:"tabItem_Ymn6"};var a=r(74848);function l(e){let{children:t,hidden:r,className:l}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,s.A)(n.tabItem,l),hidden:r,children:t})}},97808:(e,t,r)=>{r.d(t,{Ay:()=>i,RM:()=>a});var s=r(74848),n=r(28453);const a=[];function l(e){const t={a:"a",admonition:"admonition",p:"p",...(0,n.R)(),...e.components};return(0,s.jsx)(t.admonition,{type:"tip",children:(0,s.jsxs)(t.p,{children:["Want to see a real-world example of how Adapty SDK is integrated into a mobile app? Check out our ",(0,s.jsx)(t.a,{href:"sample-apps",children:"sample apps"}),", which demonstrate the full setup, including displaying paywalls, making purchases, and other basic functionality."]})})}function i(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}}}]);