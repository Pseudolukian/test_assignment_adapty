"use strict";(self.webpackChunkadapty_docs=self.webpackChunkadapty_docs||[]).push([[7310],{11470:(e,n,t)=>{t.d(n,{A:()=>w});var r=t(96540),i=t(34164),s=t(23104),a=t(56347),o=t(205),l=t(57485),d=t(31682),c=t(70679);function h(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return h(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:i}}=e;return{value:n,label:t,attributes:r,default:i}}))}(t);return function(e){const n=(0,d.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function u(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function x(e){let{queryString:n=!1,groupId:t}=e;const i=(0,a.W6)(),s=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,l.aZ)(s),(0,r.useCallback)((e=>{if(!s)return;const n=new URLSearchParams(i.location.search);n.set(s,e),i.replace({...i.location,search:n.toString()})}),[s,i])]}function y(e){const{defaultValue:n,queryString:t=!1,groupId:i}=e,s=p(e),[a,l]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!u({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=t.find((e=>e.default))??t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:s}))),[d,h]=x({queryString:t,groupId:i}),[y,g]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[i,s]=(0,c.Dv)(t);return[i,(0,r.useCallback)((e=>{t&&s.set(e)}),[t,s])]}({groupId:i}),j=(()=>{const e=d??y;return u({value:e,tabValues:s})?e:null})();(0,o.A)((()=>{j&&l(j)}),[j]);return{selectedValue:a,selectValue:(0,r.useCallback)((e=>{if(!u({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);l(e),h(e),g(e)}),[h,g,s]),tabValues:s}}var g=t(92303);const j={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=t(74848);function m(e){let{className:n,block:t,selectedValue:r,selectValue:a,tabValues:o}=e;const l=[],{blockElementScrollPositionUntilNextRender:d}=(0,s.a_)(),c=e=>{const n=e.currentTarget,t=l.indexOf(n),i=o[t].value;i!==r&&(d(n),a(i))},h=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":t},n),children:o.map((e=>{let{value:n,label:t,attributes:s}=e;return(0,f.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>l.push(e),onKeyDown:h,onClick:c,...s,className:(0,i.A)("tabs__item",j.tabItem,s?.className,{"tabs__item--active":r===n}),children:t??n},n)}))})}function v(e){let{lazy:n,children:t,selectedValue:i}=e;const s=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=s.find((e=>e.props.value===i));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==i})))})}function b(e){const n=y(e);return(0,f.jsxs)("div",{className:(0,i.A)("tabs-container",j.tabList),children:[(0,f.jsx)(m,{...n,...e}),(0,f.jsx)(v,{...n,...e})]})}function w(e){const n=(0,g.A)();return(0,f.jsx)(b,{...e,children:h(e.children)},String(n))}},19365:(e,n,t)=>{t.d(n,{A:()=>a});t(96540);var r=t(34164);const i={tabItem:"tabItem_Ymn6"};var s=t(74848);function a(e){let{children:n,hidden:t,className:a}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.A)(i.tabItem,a),hidden:t,children:n})}},36873:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>o,metadata:()=>d,toc:()=>h});var r=t(74848),i=t(28453),s=(t(26393),t(11470)),a=t(19365);const o={title:"React Native \u2014 What's new",description:"Seamlessly migrate to React Native 2 with Adapty\u2019s comprehensive migration guide.",metadataTitle:"Migrating to React Native 2 | Adapty Docs"},l=void 0,d={id:"migration-to-react-native-2",title:"React Native \u2014 What's new",description:"Seamlessly migrate to React Native 2 with Adapty\u2019s comprehensive migration guide.",source:"@site/versioned_docs/version-3.0/migration-to-react-native-2.md",sourceDirName:".",slug:"/migration-to-react-native-2",permalink:"/test_assignment_adapty/docs/migration-to-react-native-2",draft:!1,unlisted:!1,tags:[],version:"3.0",frontMatter:{title:"React Native \u2014 What's new",description:"Seamlessly migrate to React Native 2 with Adapty\u2019s comprehensive migration guide.",metadataTitle:"Migrating to React Native 2 | Adapty Docs"}},c={},h=[{value:"Synopsis",id:"synopsis",level:3},{value:"Activation",id:"activation",level:3},{value:"Logging and debugging",id:"logging-and-debugging",level:3},{value:"Profile",id:"profile",level:3},{value:"Getting paywalls",id:"getting-paywalls",level:3},{value:"Getting products",id:"getting-products",level:3},{value:"Introductory offer eligibility",id:"introductory-offer-eligibility",level:3},{value:"Products fetch policy",id:"products-fetch-policy",level:3},{value:"Making purchases",id:"making-purchases",level:3},{value:"Updating attribution",id:"updating-attribution",level:3},{value:"Promos",id:"promos",level:3},{value:"Event listeners",id:"event-listeners",level:3},{value:"In lieu of a conclusion",id:"in-lieu-of-a-conclusion",level:3}];function p(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.p,{children:"In the new version of the Adapty SDK, we've made quite a lot of changes to the internal implementation of our SDK, applying all of our accumulated experience. We also redesigned our public API and relationships between some entities so that it causes as little misunderstanding as possible and reduces the number of errors made by developers."}),"\n",(0,r.jsx)(n.p,{children:"First, let's outline the things that have changed, and then let's discuss every item individually."}),"\n",(0,r.jsx)(n.h3,{id:"synopsis",children:"Synopsis"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#activation",children:"Activation"})," \u2014 function moved to ",(0,r.jsx)(n.code,{children:"adapty"})," namespace, arguments redesigned"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#logging-and-debugging",children:"Logging and debugging"})," \u2014 Clear errors messages, customization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#profile",children:"Profile"})," \u2014 Methods renamed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#getting-paywalls",children:"Getting paywalls"})," \u2014 Getting only requested paywall instead of all. ",(0,r.jsx)(n.code,{children:"AdaptyPaywall"})," interface has changed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#getting-products",children:"Getting products"})," \u2014 Getting list of products of a provided paywall separately. ",(0,r.jsx)(n.code,{children:"AdaptyProduct"})," interface has changed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#introductory-offer-eligibility",children:"Introductory offer eligibility"})," \u2013 Instead of a boolean, now there is an extended list of options"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#products-fetch-policy",children:"Products fetch policy"})," \u2013 Ability to explicitly get products after we send the receipt to our servers"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#making-purchases",children:"Making purchases"})," \u2014 Method renamed. Removed the ",(0,r.jsx)(n.code,{children:"offerId"})," parameter"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#updating-attribution",children:"Updating attribution"})," \u2014 Arguments changed order"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#promos",children:"Promos"})," \u2014 Promo API discontinued. All methods removed"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"#event-listeners",children:"Event listeners"})," \u2014 Events changed"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"activation",children:"Activation"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Methods"}),(0,r.jsx)(n.br,{}),"\n","In SDK v1, there was a separate ",(0,r.jsx)(n.code,{children:"activateAdapty"})," function, that you would import. It read one object argument with all the parameters for initialization."]}),"\n",(0,r.jsx)(n.p,{children:"In SDK v2 there are several changes:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["It is now a method ",(0,r.jsx)(n.code,{children:"activate"})," of ",(0,r.jsx)(n.code,{children:"adapty"})," namespace, so you would only need to import ",(0,r.jsx)(n.code,{children:"adapty"})," instance"]}),"\n",(0,r.jsxs)(n.li,{children:["All the parameters besides ",(0,r.jsx)(n.code,{children:"sdkKey"})," are now expected from the second argument (refer to example)"]}),"\n",(0,r.jsxs)(n.li,{children:["For a ",(0,r.jsx)(n.code,{children:"logLevel"})," parameter, you may now import JavaScript-friendly ",(0,r.jsx)(n.code,{children:"LogLevel"})," to make sure you provide a valid value. TypeScript string validation remains"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Example"}),(0,r.jsx)(n.br,{}),"\n","Note, that you can switch tabs:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v2.0.0 (New)"})," is an example of basic and precise activations for SDK v2"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v1.x.x (Previous)"})," is an example of basic and precise activations for a latest ",(0,r.jsx)(n.code,{children:"v1.x.x"})," version"]}),"\n"]}),"\n",(0,r.jsxs)(s.A,{groupId:"current-os",queryString:!0,children:[(0,r.jsx)(a.A,{value:"Swift",label:"v2.0.0 (New)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK 2.0.0\n\nimport { adapty, LogLevel } from 'react-native-adapty';\n\n// Basic setup:\nawait adapty.activate('MY_API_KEY');\n\n// Or precise setup:\nawait adapty.activate('MY_API_KEY', {\n\tcustomerUserId: 'MY_USER_ID',\n\tobserverMode: true,\n\tlogLevel: LogLevel.VERBOSE, // \u2190 can be replaced with a string 'verbose' too\n});\n"})})}),(0,r.jsx)(a.A,{value:"kotlin",label:"v1.x.x (Previous)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK 1.x.x\n\nimport { activateAdapty } from 'react-native-adapty';\n\n// Basic setup:\nawait activateAdapty({\n\tsdkKey: 'MY_API_KEY',\n});\n\n// Or precise setup:\nawait activateAdapty({\n\tsdkKey: 'MY_API_KEY',\n\tcustomerUserId: 'MY_USER_ID',\n\tobserverMode: true,\n\tlogLevel: 'verbose',\n});\n"})})})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Motivation"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Simplifying the most common usage scenario"}),"\n",(0,r.jsxs)(n.li,{children:["Excluding ambiguous functions outside ",(0,r.jsx)(n.code,{children:"adapty"})," scope"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"logging-and-debugging",children:"Logging and debugging"}),"\n",(0,r.jsx)(n.p,{children:"In SDK v2 there are several new features:"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Error prefixes"}),(0,r.jsx)(n.br,{}),"\n","In SDK v2 you can now prepend a string to all Adapty error logs. It is ok to call this before initialization and wherever you want."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:'showLineNumbers title="Typescript"',children:"import { AdaptyError } from 'react-native-adapty';\n\nAdaptyError.prefix = \"[ADAPTY]\";\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Understandable logs"}),(0,r.jsx)(n.br,{}),"\n",'If you were trying to log error message, you would previously see "Unknown Adapty Error", as message was not handled by stdout. In SDK v2 logging errors are clear and concise.',(0,r.jsx)(n.br,{}),"\n","This is an example: ",(0,r.jsx)(n.code,{children:"[ADAPTY] #2002 (notActivated): The Adapty is not activated"})]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"[ADAPTY]"})," is a prefix, that you can manually set as stated above"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"#2002"})," is an Adapty code for you to Google around"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"notActivated"})," is a string representation of a code. It might give you enough info to do a fix"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"The Adapty is not activated"})," is a ",(0,r.jsx)(n.code,{children:"localizedDescription"})," field from SDK v1"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Error hooks"}),(0,r.jsx)(n.br,{}),"\n","You can now handle all the Adapty errors from any given place with ",(0,r.jsx)(n.code,{children:"onError"})," hook. It will send to a callback all the registered AdaptyErrors right after they are created"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:'showLineNumbers title="Typescript"',children:"import { AdaptyError } from 'react-native-adapty';\n\nAdaptyError.onError = error => {\n\t// ...\n};\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.strong,{children:["Changing ",(0,r.jsx)(n.code,{children:"logLevel"})," in a runtime"]}),(0,r.jsx)(n.br,{}),"\n","Now you can change your ",(0,r.jsx)(n.code,{children:"logLevel"})," without reinitializing the SDK."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:'showLineNumbers title="Typescript"',children:"import { adapty, LogLevel } from 'react-native-adapty';\n\nadapty.setLogLevel(LogLevel.WARN); // string 'warn' would also work\n"})}),"\n",(0,r.jsx)(n.h3,{id:"profile",children:"Profile"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Methods"}),(0,r.jsx)(n.br,{}),"\n","Previously, in SDK v1,  there were  several methods:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"adapty.purchases.getInfo"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"adapty.profile.identify"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"adapty.profile.logout"})}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"adapty.profile.update"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"In SDK v2, methods are renamed:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"adapty.purchases.getInfo"})," \u2192 ",(0,r.jsx)(n.code,{children:"adapty.getProfile"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"adapty.profile.identify"})," \u2192 ",(0,r.jsx)(n.code,{children:"adapty.identify"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"adapty.profile.logout"})," \u2192 ",(0,r.jsx)(n.code,{children:"adapty.logout"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"adapty.profile.update"})," \u2192 ",(0,r.jsx)(n.code,{children:"adapty.updateProfile"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Example"}),(0,r.jsx)(n.br,{}),"\n","Note, that you can switch tabs:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v2.0.0 (New)"})," is an example of getting user profile for SDK v2"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v1.x.x (Previous)"})," is an example of getting user profile for a latest ",(0,r.jsx)(n.code,{children:"v1.x.x"})," SDK version"]}),"\n"]}),"\n",(0,r.jsxs)(s.A,{groupId:"current-os",queryString:!0,children:[(0,r.jsx)(a.A,{value:"Swift",label:"v2.0.0 (New)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:'// AdaptySDK 2.0.0\n\nawait adapty.identify();\n\nconst profile = await adapty.getProfile();\n\nawait adapty.updateProfile({firstName: "John", lastName: "Doe" });\n\nawait adapty.logout();\n'})})}),(0,r.jsx)(a.A,{value:"kotlin",label:"v1.x.x (Previous)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:'// AdaptySDK 1.x.x\n\nawait adapty.profile.identify();\n\nconst profile = await adapty.purchases.getInfo({ forceUpdate: true });\n\nawait adapty.profile.update({firstName: "John", lastName: "Doe" });\n\nawait adapty.profile.logout();\n'})})})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Interfaces"})}),"\n",(0,r.jsx)(n.p,{children:"First of all, interfaces are renamed to improve readability and understanding. It is unlikely, that you've imported these to your project, but if you are, refer here:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"AdaptyPurchaserInfo"})," \u2192 ",(0,r.jsx)(n.code,{children:"AdaptyProfile"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"AdaptyProfile"})," \u2192 ",(0,r.jsx)(n.code,{children:"AdaptyProfileParameters"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"AdaptyPaidAccessLevelsInfo"})," \u2192 ",(0,r.jsx)(n.code,{children:"AdaptyAccessLevel"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"AdaptyNonSubscriptionsInfo"})," \u2192 ",(0,r.jsx)(n.code,{children:"AdaptyNonSubscription"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"AdaptySubscriptionsInfo"})," \u2192 ",(0,r.jsx)(n.code,{children:"AdaptySubscription"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"AdaptyOfferType"})," \u2192 ",(0,r.jsx)(n.code,{children:"OfferType"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"AdaptyVendorStore"})," \u2192 ",(0,r.jsx)(n.code,{children:"VendorStore"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"If you are using JavaScript, there are several new objects that may guarantee you safe values. You may import and use them as enums:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"OfferType"})," for example in ",(0,r.jsx)(n.code,{children:"AdaptyAccessLevel.activeIntroductoryOfferType"})," and many more"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"CancellationReason"})," for example in ",(0,r.jsx)(n.code,{children:"AdaptyAccessLevel.cancellationReason"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"VendorStore"})," for example in ",(0,r.jsx)(n.code,{children:"AdaptyAccessLevel.store"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"AppTrackingTransparencyStatus"})," in ",(0,r.jsx)(n.code,{children:"AdaptyProfileParameters.appTrackingTransparencyStatus"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Gender"})," in ",(0,r.jsx)(n.code,{children:"AdaptyProfileParameters.gender"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Below you may find an extensive diff for every ",(0,r.jsx)(n.em,{children:"profile"})," interface:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-diff",metastring:'showLineNumbers title="Profile interfaces diff"',children:"// Returned from `getProfile`, `makePurchase`, `restorePurchases`\n-interface AdaptyPurchaserInfo {\n+interface AdaptyProfile {\n\taccessLevels?: Record<string, AdaptyAccessLevel>;\n+\tcustomAttributes: Partial<AdaptyProfileParameters>;\n-\tcustomerUserId: string;\n+\tcustomerUserId?: string;\n\tnonSubscriptions?: Record<string, AdaptyNonSubscription[]>;\n\tprofileId: string;\n\tsubscriptions?: Record<string, AdaptySubscription>;\n}\n\n-interface AdaptyPaidAccessLevelsInfo {\n+interface AdaptyAccessLevel {\n-\tactivatedAt: string;\n+\tactivatedAt: Date;\n-\tactiveIntroductoryOfferType: AdaptyOfferType;\n+\tactiveIntroductoryOfferType?: OfferType;\n+\tactivePromotionalOfferId?: string;\n-\tactivePromotionalOfferType: AdaptyOfferType;\n+\tactivePromotionalOfferType?: OfferType;\n-\tbillingIssueDetectedAt?: string;\n+\tbillingIssueDetectedAt?: Date;\n+\tcancellationReason?: CancellationReason;\n-\texpiresAt: string;\n+\texpiresAt?: Date;\n\tid: string;\n\tisActive: boolean;\n\tisInGracePeriod: boolean;\n\tisLifetime: boolean;\n+\tisRefund: boolean;\n-\trenewedAt: string;\n+\trenewedAt?: Date;\n-\tstartsAt: string;\n+\tstartsAt?: Date;\n\tstore: VendorStore;\n-\tunsubscribedAt?: string;\n+\tunsubscribedAt?: Date;\n+\tvendorOriginalTransactionId?: string;\n\tvendorProductId: string;\n+\tvendorTransactionId?: string;\n\twillRenew: boolean;\n}\n\n-interface AdaptyProfile {\n+interface AdaptyProfileParameters {\n\tamplitudeDeviceId?: string;\n\tamplitudeUserId?: string;\n+\tanalyticsDisabled?: boolean;\n-\tattStatus?: 0 | 1 | 2 | 3;\n+\tappTrackingTransparencyStatus?: AppTrackingTransparencyStatus;\n\tappmetricaDeviceId?: string;\n\tappmetricaProfileId?: string;\n-\tbirthday?: Date;\n+\tbirthday?: string;\n-\tcustomAttributes: { [key: string]: any };\n+\tcodableCustomAttributes?: { [key: string]: any };\n-\tcustomerUserId: string;\n\temail?: string;\n\tfacebookAnonymousId?: string;\n-\tfacebookUserId: string;\n+\tfirebaseAppInstanceId?: string;\n\tfirstName?: string;\n-\tgender: 'male' | 'female' | 'other';\n\tgender?: Gender;\n-\tidfa: string;\n\tlastName?: string;\n\tmixpanelUserId?: string;\n+\toneSignalPlayerId?: string;\n\tphoneNumber?: string;\n+\tpushwooshHWID?: string;\n+\tstoreCountry?: string;\n}\n\n-interface AdaptyNonSubscriptionsInfo {\n+interface AdaptyNonSubscription {\n\tisOneTime: boolean;\n+\tisRefund: boolean;\n\tisSandbox: boolean;\n\tpurchaseId: string;\n-\tpurchasedAt?: string;\n+\tpurchasedAt: Date;\n\tstore: VendorStore;\n-\tvendorOriginalTransactionId: string;\n\tvendorProductId: String;\n-\tvendorTransactionId: string;\n+\tvendorTransactionId?: string;\n}\n\n-interface AdaptySubscriptionsInfo {\n+interface AdaptySubscription {\n-\tactivatedAt?: string;\n+\tactivatedAt: Date;\n-\tactiveIntroductoryOfferType: AdaptyOfferType;\n+\tactiveIntroductoryOfferType?: OfferType;\n+\tactivePromotionalOfferId?: string;\n\tactivePromotionalOfferType?: OfferType;\n-\tbillingIssueDetectedAt?: string;\n+\tbillingIssueDetectedAt?: Date;\n-\tcancellationReason?: string;\n+\tcancellationReason?: CancellationReason;\n-\texpiresAt?: string;\n+\texpiresAt?: Date;\n\tisActive: boolean;\n\tisInGracePeriod: boolean;\n\tisLifetime: boolean;\n\tisRefund: boolean;\n\tisSandbox: boolean;\n-\trenewedAt?: string;\n+\trenewedAt?: Date;\n-\tstartsAt?: string;\n+\tstartsAt?: Date;\n\tstore: VendorStore;\n-\tunsubscribedAt?: string;\n+\tunsubscribedAt?: Date;\n-\tvendorOriginalTransactionId?: string;\n+\tvendorOriginalTransactionId: string;\n\tvendorProductId: string;\n-\tvendorTransactionId?: string;\n+\tvendorTransactionId: string;\n\twillRenew: boolean;\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Motivation"}),(0,r.jsx)(n.br,{}),"\n","This name reflects the essence of the model much more correctly, because not every user is a subscriber"]}),"\n",(0,r.jsx)(n.h3,{id:"getting-paywalls",children:"Getting paywalls"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Methods"}),(0,r.jsx)(n.br,{}),"\n","In SDK v1 there you could use ",(0,r.jsx)(n.code,{children:"adapty.paywalls.getPaywalls(args?: { forceUpdate?: boolean })"})," that returned a list of paywalls."]}),"\n",(0,r.jsxs)(n.p,{children:["In SDK v2, you can't fetch all paywalls at once. Instead you are expected to fetch the one you need via ",(0,r.jsx)(n.em,{children:"developer ID"}),". Moreover, in SDK v2 fetching full products is a separate method. There are 2 methods available to you:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"adapty.getPaywall(id: string)"})," fetches one paywall for a provided ",(0,r.jsx)(n.em,{children:"developer id"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"adapty.getPaywallProducts(paywall: AdaptyPaywall)"})," fetches a list of products for a provided paywall. It will be discussed in the next section"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Example"}),(0,r.jsx)(n.br,{}),"\n","Previously, developers had to query an array of paywalls and then search that array for the desired element. We have significantly simplified this use case, so now you can get only the requested object, without touching the rest.",(0,r.jsx)(n.br,{}),"\n","Note, that you can switch tabs:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v2.0.0 (New)"})," is how you can get a paywall in a new SDK v2"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v1.x.x (Previous)"})," is how you you could get a paywall and its products in SDK v1"]}),"\n"]}),"\n",(0,r.jsxs)(s.A,{groupId:"current-os",queryString:!0,children:[(0,r.jsx)(a.A,{value:"Swift",label:"v2.0.0 (New)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK 2.0.0\n\nconst paywall = await adapty.getPaywall('YOUR_PLACEMENT_ID');\n"})})}),(0,r.jsx)(a.A,{value:"kotlin",label:"v1.x.x (Previous)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK 1.x.x\n\nconst { paywalls } = await adapty.paywalls.getPaywalls({ forceUpdate: true });\n// Find your preferred paywall. For example:\nconst paywall = paywalls.find(paywall => paywall.developerId === 'MY_PAYWALL');\n"})})})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Logging"}),(0,r.jsx)(n.br,{}),"\n","Previously, in SDK v1 there was a ",(0,r.jsx)(n.code,{children:"adapty.paywalls.logShow"})," method to log, that user has opened a paywall.",(0,r.jsx)(n.br,{}),"\n","In SDK v2 there are two separate methods now:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"adapty.paywalls.logShow"})," is renamed to ",(0,r.jsx)(n.code,{children:"adapty.logShowPaywall"})]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"adapty.logShowOnboarding"})}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Fallback paywalls"}),(0,r.jsx)(n.br,{}),"\n","Previously, in SDK v1 there was ",(0,r.jsx)(n.code,{children:"adapty.paywalls.setFallback"})," method. In SDK v2 it is now called ",(0,r.jsx)(n.code,{children:"adapty.setFallbackPaywalls"}),"."]}),"\n",(0,r.jsxs)(s.A,{groupId:"current-os",queryString:!0,children:[(0,r.jsx)(a.A,{value:"Swift",label:"v2.0.0 (New)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK 2.0.0\n\nawait adapty.logShowPaywall();\n\nawait adapty.setFallbackPaywalls(jsonStr);\n"})})}),(0,r.jsx)(a.A,{value:"kotlin",label:"v1.x.x (Previous)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK 1.x.x\n\nawait adapty.paywalls.logShow();\n\nawait adapty.paywalls.setFallback(jsonStr);\n"})})})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Interfaces"}),(0,r.jsx)(n.br,{}),"\n","Below you can find all the changes introduced in v2.0.0 to ",(0,r.jsx)(n.code,{children:"AdaptyPaywall"})," interface. Note, that you can switch tabs:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"Changes"})," is a diff, that shows what have been removed and what have been added. Comments are provided"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v2.0.0 (New)"})," is an interface representation in a new SDK v2"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v1.x.x (Previous)"})," is an interface representation in a latest ",(0,r.jsx)(n.code,{children:"v1.x.x"})," version"]}),"\n"]}),"\n",(0,r.jsxs)(s.A,{groupId:"current-os",queryString:!0,children:[(0,r.jsx)(a.A,{value:"Swift",label:"Changes",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:"interface AdaptyPaywall {\n-\tabTestName?: string; // it is now required\n+\tabTestName: string;\n-\tcustomPayloadString?: string; // renamed to `remoteConfigString`\n+\tremoteConfigString?: string;\n+\tremoteConfig?: string; // parsed JSON from `remoteConfigString`\n-\tdeveloperId: string; // renamed to `id`\n+\tid: string;\n-\tisPromo: boolean; // Promos are no longer supported\n\tname?: string;\n-\tproducts: AdaptyProduct[]; // Full products are no longer fetched\n+\tvendorProductIds: string[]; // List of vendor ids is fetched instead\n\trevision: number;\n\tvariationId: string;\n-\tvisualPaywall?: string; // Visual paywalls are not currently supported\n}\n"})})}),(0,r.jsx)(a.A,{value:"kotlin",label:"v2.0.0 (New)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK 2.0.0\n\nexport interface AdaptyPaywall {\n\treadonly abTestName: string;\n\treadonly id: string;\n\treadonly name?: string;\n\treadonly remoteConfig?: Record<string, any>;\n\treadonly remoteConfigString?: string;\n\treadonly revision: number;\n\treadonly variationId: string;\n\treadonly vendorProductIds?: string[];\n}\n"})})}),(0,r.jsx)(a.A,{value:"java",label:"v1.x.x (Previous)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK 1.x.x\n\nexport interface AdaptyPaywall {\n\tabTestName?: string;\n\tcustomPayloadString?: string;\n\tdeveloperId: string;\n\tisPromo: boolean;\n\tname?: string;\n\tproducts: AdaptyProduct[];\n\trevision: number;\n\tvariationId: string;\n\tvisualPaywall?: string;\n}\n"})})})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Motivation"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"Simplifying the most common usage scenario"}),"\n",(0,r.jsx)(n.li,{children:"Reduce internet traffic, to immensely improve response time"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"getting-products",children:"Getting products"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Methods"}),(0,r.jsx)(n.br,{}),"\n","Previously, in SDK v1 a product list was a part of ",(0,r.jsx)(n.code,{children:"AdaptyPaywall"}),". Now in SDK v2 a product list is independent, although it can only exist in the context of the ",(0,r.jsx)(n.code,{children:"AdaptyPaywall"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["There is a new method to get products: ",(0,r.jsx)(n.code,{children:"adapty.getPaywallProducts(paywall)"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Example"}),(0,r.jsx)(n.br,{}),"\n","Note, that you can switch tabs:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"`v2.0.0 (New) is how you can query products in SDK v2"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v1.x.x (Previous)"})," is how you could query products in SDK v1"]}),"\n"]}),"\n",(0,r.jsxs)(s.A,{groupId:"current-os",queryString:!0,children:[(0,r.jsx)(a.A,{value:"Swift",label:"v2.0.0 (New)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK 2.0.0\n\nconst paywall = await adapty.getPaywall('YOUR_PLACEMENT_ID');\nconst products = await adapty.getPaywallProducts(paywall);\n"})})}),(0,r.jsx)(a.A,{value:"kotlin",label:"v1.x.x (Previous)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK 1.x.x\n\nconst { paywalls } = await adapty.paywalls.getPaywalls({ forceUpdate: true });\n// Find your preferred paywall. For example:\nconst paywall = paywalls.find(paywall => paywall.developerId === 'MY_PAYWALL');\nconst products = paywall.products;\n"})})})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Interface"}),(0,r.jsx)(n.br,{}),"\n","Two interfaces slightly changed: ",(0,r.jsx)(n.code,{children:"AdaptyProduct"})," and ",(0,r.jsx)(n.code,{children:"AdaptyProductDiscount"}),". You may find diff below",(0,r.jsx)(n.br,{}),"\n","Interfaces renamed:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"AdaptyProductSubscriptionPeriod"})," \u2192 ",(0,r.jsx)(n.code,{children:"AdaptySubscriptionPeriod"})]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-diff",metastring:'showLineNumbers title="Diff"',children:"interface AdaptyProduct {\n-\tcurrencyCode: string;\n+\tcurrencyCode?: string;\n-\tcurrencySymbol: string;\n+\tcurrencySymbol?: string;\n\tintroductoryDiscount?: AdaptyProductDiscount;\n-\tintroductoryOfferEligibility: boolean;\n+\tintroductoryOfferEligibility: OfferEligibility;\n\tlocalizedDescription: string;\n-\tlocalizedPrice: string;\n+\tlocalizedPrice?: string;\n\tlocalizedSubscriptionPeriod?: string;\n\tlocalizedTitle: string;\n-\tpaywallABTestName?: string;\n+\tpaywallABTestName: string;\n-\tpaywallName?: string;\n+\tpaywallName: string;\n\tprice: number;\n\tsubscriptionPeriod: AdaptySubscriptionPeriod;\n-\tvariationId?: string;\n+\tvariationId: string;\n\tvendorProductId: string;\n  \n\tandroid?: {\n\t\tfreeTrialPeriod?: AdaptySubscriptionPeriod;\n+\t\tlocalizedFreeTrialPeriod?: string;\n\t};\n\tios?: {\n\t\tdiscounts: AdaptyProductDiscount[];\n\t\tisFamilyShareable: boolean;\n-\t\tpromotionalOfferEligibility: boolean;\n+\t\tpromotionalOfferEligibility: OfferEligibility;\n\t\tpromotionalOfferId?: string;\n\t\tregionCode?: string;\n\t\tsubscriptionGroupIdentifier?: string;\n\t};\n}\n\n\ninterface AdaptyProductDiscount {\n+\tlocalizedNumberOfPeriods?: string;\n-\tlocalizedPrice: string;\n+\tlocalizedPrice?: string;\n-\tlocalizedSubscriptionPeriod: string;\n+\tlocalizedSubscriptionPeriod?: string;\n\tnumberOfPeriods: number;\n\tprice: number;\n\tsubscriptionPeriod: AdaptySubscriptionPeriod;\n\n\tios?: {\n\t\tidentifier?: string;\n\t\tpaymentMode: OfferType;\n-\t\tlocalizedNumberOfPeriods?: string; // now crossplatform\n\t};\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Motivation:"}),(0,r.jsx)(n.br,{}),"\n","We believe that this architecture will provide more flexibility in terms of receiving paywalls and products (for example, now you are not blocked by Apple when you receive a paywall), and will also optimize the load on the servers, which will speed up the response. Also, this approach is less error-prone."]}),"\n",(0,r.jsxs)(n.admonition,{type:"warning",children:[(0,r.jsx)(n.p,{children:"Products outside the paywalls"}),(0,r.jsx)(n.p,{children:"If you for some reason want to work with a product (or an array of products), please create a paywall for it. This approach is great for scaling and analytics."})]}),"\n",(0,r.jsx)(n.h3,{id:"introductory-offer-eligibility",children:"Introductory offer eligibility"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"AdaptyProduct"})," entity has the ",(0,r.jsx)(n.code,{children:"introductoryOfferEligibility"})," property, that determines whether the introductory offer is available to the user (for example, a free trial period)."]}),"\n",(0,r.jsxs)(n.p,{children:["In SDK v1 it was a boolean value. In SDK v2 now it is a string union ",(0,r.jsx)(n.code,{children:"'eligible' | 'ineligible' | 'unknown''"}),". You can also import ",(0,r.jsx)(n.code,{children:"OfferEligibility"})," enum object if you need."]}),"\n",(0,r.jsx)(n.p,{children:"Note, that you can switch tabs:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v2.0.0 (New)"})," is how you can handle ",(0,r.jsx)(n.code,{children:"introductoryOfferEligibility"})," in SDK v2"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v1.x.x (Previous)"})," is how you handled ",(0,r.jsx)(n.code,{children:"introductoryOfferEligibility"})," in SDK v1"]}),"\n"]}),"\n",(0,r.jsxs)(s.A,{groupId:"current-os",queryString:!0,children:[(0,r.jsx)(a.A,{value:"Swift",label:"v2.0.0 (New)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK 2.0.0\n\nimport { OfferEligibility } from 'react-native-adapty';\n// ...\nswitch (product.introductoryOfferEligibility) {\n\tcase OfferEligibility.Eligible: // or 'eligible' string\n\t\t// ...\n\tcase OfferEligibility.Ineligible: // or 'ineligible' string\n\t\t// ...\n  case OfferEligibility.Unknown: // or 'unknown' string\n\t\t// ...\n}\n"})})}),(0,r.jsx)(a.A,{value:"kotlin",label:"v1.x.x (Previous)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK 1.x.x\n\n// ...\nif (product.introductoryOfferEligibility) {\n\t// ...\n} else {\n\t// ...\n}\n"})})})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Motivation"}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.strong,{children:"StoreKit"})," does not provide a convenient and reliable way to determine this value, so we have to do it by analyzing the receipt from the system. Since there are cases when this receipt is missing, we decided to inform you about these situations using the value ",(0,r.jsx)(n.code,{children:"unknown"}),". We recommend working with ",(0,r.jsx)(n.code,{children:"unknown"})," in the same way as ",(0,r.jsx)(n.code,{children:"ineligible"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"products-fetch-policy",children:"Products fetch policy"}),"\n",(0,r.jsxs)(n.p,{children:["Previously, SDK v1 did not allow you to reliably determine the value of the ",(0,r.jsx)(n.code,{children:"introductoryOfferEligibility"})," without analyzing the receipt. Despite the fact that a missing receipt at startup is a pretty rare situation, we have added the ability to explicitly get products after we send the receipt to our servers."]}),"\n",(0,r.jsxs)(n.p,{children:["In SDK v2 we will try to request a receipt in its unavailability in advance, and there is a special parameter of ",(0,r.jsx)(n.code,{children:"getPaywallProducts"})," function to get products with a correct ",(0,r.jsx)(n.code,{children:"introductoryOfferEligibility"})]}),"\n",(0,r.jsxs)(n.p,{children:["On JavaScript you can import ",(0,r.jsx)(n.code,{children:"FetchPolicy"})," object to validate the passing values."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:'showLineNumbers title="Typescript"',children:"// AdaptySDK v2.0.0\nadapty.getPaywallProducts({ios: { fetchPolicy: 'waitForReceiptValidation' }});\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Motivation"}),(0,r.jsx)(n.br,{}),"\n","We recommend first requesting products without overriding ",(0,r.jsx)(n.code,{children:"fetchPolicy"}),", and then immediately rendering the UI. If you get back objects with an unknown ",(0,r.jsx)(n.code,{children:"introductoryOfferEligibility"})," value, you can re-request products with ",(0,r.jsx)(n.code,{children:"waitForReceiptValidation"})," policy and update the UI afterward.",(0,r.jsx)(n.br,{}),"\n","Read more about handling such a scenario in the ",(0,r.jsx)(n.a,{href:"display-remote-config-paywalls",children:(0,r.jsx)(n.em,{children:"Displaying Paywalls & Products"})})," section."]}),"\n",(0,r.jsx)(n.h3,{id:"making-purchases",children:"Making purchases"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Methods"}),(0,r.jsx)(n.br,{}),"\n","Previously, in SDK v1 there was one method: ",(0,r.jsx)(n.code,{children:"adapty.purchases.makePurchase"}),", that accepted product and platform-specific offer IDs."]}),"\n",(0,r.jsxs)(n.p,{children:["In SDK v2 the method is renamed to ",(0,r.jsx)(n.code,{children:"adapty.makePurchase"}),". It only accepts a product now. If your paywall has an active promotional offer for the product you are attempting to purchase, Adapty will automatically apply that offer at the time of purchase."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Example"}),(0,r.jsx)(n.br,{}),"\n","Note that you can switch tabs:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v2.0.0 (New)"})," is how you can make a purchase in SDK v2"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v1.x.x (Previous)"})," is how you could make a purchase in SDK v1"]}),"\n"]}),"\n",(0,r.jsxs)(s.A,{groupId:"current-os",queryString:!0,children:[(0,r.jsx)(a.A,{value:"Swift",label:"v2.0.0 (New)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK v2.0.0\n\nawait adapty.makePurchase(product);\n"})})}),(0,r.jsx)(a.A,{value:"kotlin",label:"v1.x.x (Previous)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK v1.x.x\n\nawait adapty.purchases.makePurchase(product, { ios: { offerId: offerId }});\n"})})})]}),"\n",(0,r.jsx)(n.admonition,{type:"warning",children:(0,r.jsxs)(n.p,{children:["Adapty signs the request according to Apple guidelines, please make sure you've uploaded ",(0,r.jsx)(n.a,{href:"app-store-connection-configuration#step-3-upload-in-app-purchase-key-file",children:"Subscription Key"})," in Adapty Dashboard when using promotional offers."]})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Other purchase methods"})}),"\n",(0,r.jsx)(n.p,{children:"Previously, in SDK v1 there were 2 more methods:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"adapty.purchases.setVariationId"})," to inform Adapty about paywall purchases in ",(0,r.jsx)(n.em,{children:"Observer Mode"})]}),"\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.code,{children:"adapty.purchases.restore"})}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"In SDK v2 these methods have been renamed:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"adapty.purchases.setVariationId"})," \u2192 ",(0,r.jsx)(n.code,{children:"adapty.setVariationId"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"adapty.purchases.restore"})," \u2192 ",(0,r.jsx)(n.code,{children:"adapty.restorePurchases"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Example"}),(0,r.jsx)(n.br,{}),"\n","Note that you can switch tabs:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v2.0.0 (New)"})," is how you can set a ",(0,r.jsx)(n.code,{children:"variationId"})," in SDK v2"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v1.x.x (Previous)"})," is how you could set a ",(0,r.jsx)(n.code,{children:"variationId"})," in SDK v1"]}),"\n"]}),"\n",(0,r.jsxs)(s.A,{groupId:"current-os",queryString:!0,children:[(0,r.jsx)(a.A,{value:"Swift",label:"v2.0.0 (New)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK v2.0.0\n\nawait adapty.setVariationId(variationId, transactionId);\n\nawait adapty.restorePurchases();\n"})})}),(0,r.jsx)(a.A,{value:"kotlin",label:"v1.x.x (Previous)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK v1.x.x\n\nawait adapty.purchases.setVariationId(variationId, transactionId);\n\nawait adapty.purchases.restore();\n"})})})]}),"\n",(0,r.jsx)(n.h3,{id:"updating-attribution",children:"Updating attribution"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Methods"}),(0,r.jsx)(n.br,{}),"\n","Previously, in SDK v1 you needed to pass three arguments to an ",(0,r.jsx)(n.code,{children:"updateAttribution"})," call: ",(0,r.jsx)(n.code,{children:"networkUserId: string"}),", ",(0,r.jsx)(n.code,{children:"attribution: Object"}),", ",(0,r.jsx)(n.code,{children:"source: string union"})," consecutively.",(0,r.jsx)(n.br,{}),"\n","It caused a problem for several sources: they do not provide an exposed ",(0,r.jsx)(n.code,{children:"networkUserId"}),", which was handled in SDK v2."]}),"\n",(0,r.jsx)(n.p,{children:"In SDK v2, there are several changes:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Arguments now have different order to make ",(0,r.jsx)(n.code,{children:"networkUserId"})," optional: ",(0,r.jsx)(n.code,{children:"attribution"}),", ",(0,r.jsx)(n.code,{children:"source"}),", then optional ",(0,r.jsx)(n.code,{children:"networkUserId"})]}),"\n",(0,r.jsxs)(n.li,{children:["For a ",(0,r.jsx)(n.code,{children:"source"})," parameter, you may now import JavaScript-friendly ",(0,r.jsx)(n.code,{children:"AttributionSource"})," object to make sure you provide a valid value. TypeScript string validation remains"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Example"}),(0,r.jsx)(n.br,{}),"\n","Note, that you can switch tabs:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v2.0.0 (New)"})," is an example of updating attribution for SDK v2"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"v1.x.x (Previous)"})," is an example of updating attribution for a latest ",(0,r.jsx)(n.code,{children:"v1.x.x"})," SDK version"]}),"\n"]}),"\n",(0,r.jsxs)(s.A,{groupId:"current-os",queryString:!0,children:[(0,r.jsx)(a.A,{value:"Swift",label:"v2.0.0 (New)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK 2.0.0\n\nimport { adapty, AttributionSource } from 'react-native-adapty';\n\n// AppsFlyer example\nappsFlyer.onInstallConversionData((installData) => {\n\tconst networkUserId = appsFlyer.getAppsFlyerUID();\n  \n\tawait adapty.updateAttribution(\n\t\tinstallData,\n\t\tAttributionSource.AppsFlyer, // \u2190 can be replaced with a string 'AppsFlyer' too\n\t\tnetworkUserId,\n\t);\n});\n"})})}),(0,r.jsx)(a.A,{value:"kotlin",label:"v1.x.x (Previous)",default:!0,children:(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"// AdaptySDK 1.x.x\n\nimport { adapty } from 'react-native-adapty';\n\n// AppsFlyer example\nappsFlyer.onInstallConversionData((installData) => {\n\tconst networkUserId = appsFlyer.getAppsFlyerUID();\n  \n\tawait adapty.updateAttribution(\n\t\tnetworkUserId,\n\t\tinstallData,\n\t\t'AppsFlyer',\n\t);\n});\n"})})})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Motivation"}),(0,r.jsx)(n.br,{}),"\n","As stated, with introduction of new sources, ",(0,r.jsx)(n.code,{children:"networkUserId"})," became optional. Major library update allows to change order of arguments to avoid passing something like",(0,r.jsx)(n.code,{children:'""'})]}),"\n",(0,r.jsx)(n.h3,{id:"promos",children:"Promos"}),"\n",(0,r.jsx)(n.p,{children:"Adapty no longer supports Promo Push API. All methods were removed, except iOS native one."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsxs)(n.strong,{children:[(0,r.jsx)(n.code,{children:"presentCodeRedemptionSheet"})," renamed"]}),(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.code,{children:"adapty.promo.presentCodeRedemptionSheet"})," \u2192 ",(0,r.jsx)(n.code,{children:"adapty.presentCodeRedemptionSheet"})]}),"\n",(0,r.jsx)(n.h3,{id:"event-listeners",children:"Event listeners"}),"\n",(0,r.jsx)(n.p,{children:"Previously, in SDK v1 there were 3 event listeners:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"onInfoUpdate"})," ",(0,r.jsx)(n.code,{children:"(profile: AdaptyProfile)"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"onDeferredPurchase"})," ",(0,r.jsx)(n.code,{children:"(product: AdaptyProduct)"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"onPromoReceived"})," ",(0,r.jsx)(n.code,{children:"(promo: AdaptyPromo)"})]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"In SDK v2, there are only two event listeners:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"onLatestProfileLoad"})," ",(0,r.jsx)(n.code,{children:"(profile: AdaptyProfile)"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"onDeferredPurchase"})," ",(0,r.jsx)(n.code,{children:"(profile: AdaptyProfile)"})]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["Deferred purchase event now sends a ",(0,r.jsx)(n.code,{children:"AdaptyProfile"})," callback instead of a product. ",(0,r.jsx)(n.code,{children:"onLatestProfileLoad"})," replaces ",(0,r.jsx)(n.code,{children:"onInfoUpdate"})," and works exactly at the same times as previously"]}),"\n",(0,r.jsx)(n.h3,{id:"in-lieu-of-a-conclusion",children:"In lieu of a conclusion"}),"\n",(0,r.jsx)(n.p,{children:'In this article, we have listed the most significant changes introduced in the new version, which can be seen in the public API. However, most of the improvements are hidden "under the hood" and are not mentioned here. Of course, we\'ve completely updated our documentation to reflect the new release, so you can feel free to use it.'}),"\n",(0,r.jsxs)(n.p,{children:["You can find the complete list of changes on the ",(0,r.jsx)(n.a,{href:"https://github.com/adaptyteam/AdaptySDK-iOS/releases/tag/2.0.2",children:"release page"}),"."]}),"\n",(0,r.jsx)(n.p,{children:"Stay tuned for more updates!"})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}}}]);