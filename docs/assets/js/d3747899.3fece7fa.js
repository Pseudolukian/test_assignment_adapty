"use strict";(self.webpackChunkadapty_docs=self.webpackChunkadapty_docs||[]).push([[5302],{5673:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>d,toc:()=>o});var s=n(74848),r=n(28453);const l={title:"React Native - Handle paywall events",description:"Handle subscription-related events in React Native (Legacy) with Adapty's event tracking system.",metadataTitle:"Handling Events in React Native (Legacy) | Adapty Docs",toc_max_heading_level:4},i=void 0,d={id:"react-native-handling-events-legacy",title:"React Native - Handle paywall events",description:"Handle subscription-related events in React Native (Legacy) with Adapty's event tracking system.",source:"@site/versioned_docs/version-3.0/react-native-handling-events-legacy.md",sourceDirName:".",slug:"/react-native-handling-events-legacy",permalink:"/docs/react-native-handling-events-legacy",draft:!1,unlisted:!1,tags:[],version:"3.0",frontMatter:{title:"React Native - Handle paywall events",description:"Handle subscription-related events in React Native (Legacy) with Adapty's event tracking system.",metadataTitle:"Handling Events in React Native (Legacy) | Adapty Docs",toc_max_heading_level:4},sidebar:"tutorialSidebar",previous:{title:"Flutter",permalink:"/docs/flutter-handling-events-legacy"},next:{title:"Unity",permalink:"/docs/unity-handling-events-legacy"}},a={},o=[{value:"Event handlers",id:"event-handlers",level:3}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h3:"h3",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.p,{children:["Paywalls configured with the ",(0,s.jsx)(t.a,{href:"adapty-paywall-builder-legacy",children:"Paywall Builder"})," don't need extra code to make and restore purchases. However, they generate some events that your app can respond to. Those events include button presses (close buttons, URLs, product selections, and so on) as well as notifications on purchase-related actions taken on the paywall. Learn how to respond to these events below."]}),"\n",(0,s.jsx)(t.admonition,{type:"warning",children:(0,s.jsxs)(t.p,{children:["This guide covers the process for ",(0,s.jsx)(t.strong,{children:"legacy Paywall Builder paywalls"})," only which requires Adapty SDK up to v2.x. For presenting paywalls in Adapty SDK v3.0 or later designed with the new Paywall Builder, see ",(0,s.jsx)(t.a,{href:"react-native-handling-events-1",children:"React Native - Handle paywall events designed with new Paywall Builder"}),"."]})}),"\n",(0,s.jsxs)(t.p,{children:["To control or monitor processes occurring on the paywall screen within your mobile app, implement the",(0,s.jsx)(t.code,{children:"view.registerEventHandlers"})," method:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",metastring:'showLineNumbers title="React Native (TSX)"',children:"import {createPaywallView} from '@adapty/react-native-ui';\n\nconst view = await createPaywallView(paywall);\n\nconst unsubscribe = view.registerEventHandlers({\n  onCloseButtonPress() {\n    return true;\n  },\n  onPurchaseCompleted(profile) {\n    return true;\n  },\n  onPurchaseStarted(product) { /***/},\n  onPurchaseCancelled(product) { /***/ },\n  onPurchaseFailed(error) { /***/ },\n  onRestoreCompleted(profile) { /***/ },\n  onRestoreFailed(error) { /***/ },\n  onProductSelected() { /***/},\n  onRenderingFailed(error) { /***/ },\n  onLoadingProductsFailed(error) { /***/ },\n  onUrlPress(url) { /* handle url */ },\n});\n\n"})}),"\n",(0,s.jsx)(t.p,{children:"You can register event handlers you need, and miss those you do not need. In this case, unused event listeners would not be created."}),"\n",(0,s.jsxs)(t.p,{children:["Note that at the very least you need to implement the reactions to both ",(0,s.jsx)(t.code,{children:"onCloseButtonPress"})," and ",(0,s.jsx)(t.code,{children:"onUrlPress"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Event handlers return a boolean. If ",(0,s.jsx)(t.code,{children:"true"})," is returned, the displaying process is considered complete, thus the paywall screen closes and event listeners for this view are removed."]}),"\n",(0,s.jsxs)(t.p,{children:["Note, that ",(0,s.jsx)(t.code,{children:"onCloseButtonPress"}),", ",(0,s.jsx)(t.code,{children:"onPurchaseCompleted"})," and ",(0,s.jsx)(t.code,{children:"onRestoreCompleted"})," in the example above return ",(0,s.jsx)(t.code,{children:"true"})," \u2014 This is their default behavior that you can override."]}),"\n",(0,s.jsx)(t.h3,{id:"event-handlers",children:"Event handlers"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Event handler"}),(0,s.jsx)(t.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"onCloseButtonPress"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"If the close button is visible and a user taps it, this method will be invoked. It is recommended to dismiss the paywall screen in this handler."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"onPurchaseCompleted"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["If a user's purchase succeeds, this method will be invoked and will provide updated ",(0,s.jsx)(t.code,{children:"AdaptyProfile"}),". It is recommended to dismiss the paywall view in this handler."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"onPurchaseStarted"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:['If a user taps the "Purchase" action button to start the purchase process, this method will be invoked and will provide ',(0,s.jsx)(t.code,{children:"AdaptyPaywallProduct"}),"."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"onPurchaseCancelled"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["If a user initiates the purchase process and manually interrupts it, this method will be invoked and will provide ",(0,s.jsx)(t.code,{children:"AdaptyPaywallProduct"}),"."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"onPurchaseFailed"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["If the purchase process fails, this method will be invoked and provide ",(0,s.jsx)(t.code,{children:"AdaptyError"}),"."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"onRestoreCompleted"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["If a user's purchase restoration succeeds, this method will be invoked and provide updated ",(0,s.jsx)(t.code,{children:"AdaptyProfile"}),". It is recommended to dismiss the screen if the user has  the required ",(0,s.jsx)(t.code,{children:"accessLevel"}),". Refer to the ",(0,s.jsx)(t.a,{href:"subscription-status",children:"Subscription status"}),"   topic to learn how to check it."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"onRestoreFailed"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["If the restoring process fails, this method will be invoked and will provide ",(0,s.jsx)(t.code,{children:"AdaptyError"}),"."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"onProductSelected"})}),(0,s.jsx)(t.td,{style:{textAlign:"left"},children:"When any product in the paywall view is selected, this method will be invoked, so that you can monitor what the user selects before the purchase."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"onRenderingFailed"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["If an error occurs during view rendering, this method will be invoked and provide ",(0,s.jsx)(t.code,{children:"AdaptyError"}),". Such errors should not occur, so if you come across one, please let us know."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.strong,{children:"onLoadingProductsFailed"})}),(0,s.jsxs)(t.td,{style:{textAlign:"left"},children:["If you  haven't set ",(0,s.jsx)(t.code,{children:"prefetchProducts: true"})," in view creation, AdaptyUI will retrieve the necessary objects from the server by itself. If this operation fails, this method will be invoked and provide ",(0,s.jsx)(t.code,{children:"AdaptyError"}),"."]})]})]})]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}}}]);