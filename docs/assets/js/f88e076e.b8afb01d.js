"use strict";(self.webpackChunkadapty_docs=self.webpackChunkadapty_docs||[]).push([[7672],{11470:(e,n,a)=>{a.d(n,{A:()=>w});var t=a(96540),i=a(34164),r=a(23104),s=a(56347),o=a(205),d=a(57485),l=a(31682),c=a(70679);function p(e){return t.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:a}=e;return(0,t.useMemo)((()=>{const e=n??function(e){return p(e).map((e=>{let{props:{value:n,label:a,attributes:t,default:i}}=e;return{value:n,label:a,attributes:t,default:i}}))}(a);return function(e){const n=(0,l.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,a])}function u(e){let{value:n,tabValues:a}=e;return a.some((e=>e.value===n))}function m(e){let{queryString:n=!1,groupId:a}=e;const i=(0,s.W6)(),r=function(e){let{queryString:n=!1,groupId:a}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:n,groupId:a});return[(0,d.aZ)(r),(0,t.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(i.location.search);n.set(r,e),i.replace({...i.location,search:n.toString()})}),[r,i])]}function f(e){const{defaultValue:n,queryString:a=!1,groupId:i}=e,r=h(e),[s,d]=(0,t.useState)((()=>function(e){let{defaultValue:n,tabValues:a}=e;if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!u({value:n,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const t=a.find((e=>e.default))??a[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:r}))),[l,p]=m({queryString:a,groupId:i}),[f,y]=function(e){let{groupId:n}=e;const a=function(e){return e?`docusaurus.tab.${e}`:null}(n),[i,r]=(0,c.Dv)(a);return[i,(0,t.useCallback)((e=>{a&&r.set(e)}),[a,r])]}({groupId:i}),g=(()=>{const e=l??f;return u({value:e,tabValues:r})?e:null})();(0,o.A)((()=>{g&&d(g)}),[g]);return{selectedValue:s,selectValue:(0,t.useCallback)((e=>{if(!u({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);d(e),p(e),y(e)}),[p,y,r]),tabValues:r}}var y=a(92303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=a(74848);function j(e){let{className:n,block:a,selectedValue:t,selectValue:s,tabValues:o}=e;const d=[],{blockElementScrollPositionUntilNextRender:l}=(0,r.a_)(),c=e=>{const n=e.currentTarget,a=d.indexOf(n),i=o[a].value;i!==t&&(l(n),s(i))},p=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const a=d.indexOf(e.currentTarget)+1;n=d[a]??d[0];break}case"ArrowLeft":{const a=d.indexOf(e.currentTarget)-1;n=d[a]??d[d.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":a},n),children:o.map((e=>{let{value:n,label:a,attributes:r}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:t===n?0:-1,"aria-selected":t===n,ref:e=>d.push(e),onKeyDown:p,onClick:c,...r,className:(0,i.A)("tabs__item",g.tabItem,r?.className,{"tabs__item--active":t===n}),children:a??n},n)}))})}function v(e){let{lazy:n,children:a,selectedValue:i}=e;const r=(Array.isArray(a)?a:[a]).filter(Boolean);if(n){const e=r.find((e=>e.props.value===i));return e?(0,t.cloneElement)(e,{className:"margin-top--md"}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:r.map(((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==i})))})}function b(e){const n=f(e);return(0,x.jsxs)("div",{className:(0,i.A)("tabs-container",g.tabList),children:[(0,x.jsx)(j,{...n,...e}),(0,x.jsx)(v,{...n,...e})]})}function w(e){const n=(0,y.A)();return(0,x.jsx)(b,{...e,children:p(e.children)},String(n))}},19365:(e,n,a)=>{a.d(n,{A:()=>s});a(96540);var t=a(34164);const i={tabItem:"tabItem_Ymn6"};var r=a(74848);function s(e){let{children:n,hidden:a,className:s}=e;return(0,r.jsx)("div",{role:"tabpanel",className:(0,t.A)(i.tabItem,s),hidden:a,children:n})}},90234:(e,n,a)=>{a.r(n),a.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var t=a(74848),i=a(28453),r=a(11470),s=a(19365);const o={title:"Migration guide to Adapty React Native SDK 3.3.x",description:"",metadataTitle:""},d=void 0,l={id:"migration-to-react-native330",title:"Migration guide to Adapty React Native SDK 3.3.x",description:"",source:"@site/versioned_docs/version-3.0/migration-to-react-native330.md",sourceDirName:".",slug:"/migration-to-react-native330",permalink:"/docs/migration-to-react-native330",draft:!1,unlisted:!1,tags:[],version:"3.0",frontMatter:{title:"Migration guide to Adapty React Native SDK 3.3.x",description:"",metadataTitle:""},sidebar:"tutorialSidebar",previous:{title:"Migration guide to Unity Adapty SDK 3.3",permalink:"/docs/migration-to-unity330"},next:{title:"Migration guide to Adapty SDK v.3.0",permalink:"/docs/migration-to-adapty-sdk-v3"}},c={},p=[{value:"Upgrade Adapty React Native SDK to 3.3.x",id:"upgrade-adapty-react-native-sdk-to-33x",level:2},{value:"Changes in models",id:"changes-in-models",level:2},{value:"New models",id:"new-models",level:3},{value:"Changed models",id:"changed-models",level:3},{value:"Remove models",id:"remove-models",level:3},{value:"Remove <code>getProductsIntroductoryOfferEligibility</code> method",id:"remove-getproductsintroductoryoffereligibility-method",level:2},{value:"Update making purchase",id:"update-making-purchase",level:2},{value:"Update Paywall Builder paywall presentation",id:"update-paywall-builder-paywall-presentation",level:2},{value:"Update developer-defined timer implementation",id:"update-developer-defined-timer-implementation",level:2},{value:"Modify Paywall Builder purchase events",id:"modify-paywall-builder-purchase-events",level:2},{value:"Steps to migrate:",id:"steps-to-migrate",level:4},{value:"Modify Paywall Builder custom action events",id:"modify-paywall-builder-custom-action-events",level:2},{value:"Modify <code>onProductSelected</code> callback",id:"modify-onproductselected-callback",level:2},{value:"Remove third-party integration parameters from <code>updateProfile</code> method",id:"remove-third-party-integration-parameters-from-updateprofile-method",level:2},{value:"Update third-party integration SDK configuration",id:"update-third-party-integration-sdk-configuration",level:2},{value:"Adjust",id:"adjust",level:3},{value:"AirBridge",id:"airbridge",level:3},{value:"Amplitude",id:"amplitude",level:3},{value:"AppMetrica",id:"appmetrica",level:3},{value:"AppsFlyer",id:"appsflyer",level:3},{value:"Branch",id:"branch",level:3},{value:"Facebook Ads",id:"facebook-ads",level:3},{value:"Firebase and Google Analytics",id:"firebase-and-google-analytics",level:3},{value:"Mixpanel",id:"mixpanel",level:3},{value:"OneSignal",id:"onesignal",level:3},{value:"Pushwoosh",id:"pushwoosh",level:3},{value:"Update Observer mode implementation",id:"update-observer-mode-implementation",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"Adapty SDK 3.3.1 is a major release that brought some improvements that may require some migration steps from you."}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Upgrade to Adapty SDK v3.3.x."}),"\n",(0,t.jsx)(n.li,{children:"Update models."}),"\n",(0,t.jsxs)(n.li,{children:["Remove the ",(0,t.jsx)(n.code,{children:"getProductsIntroductoryOfferEligibility"})," method."]}),"\n",(0,t.jsx)(n.li,{children:"Update making purchase."}),"\n",(0,t.jsx)(n.li,{children:"Update Paywall Builder paywall presentation."}),"\n",(0,t.jsx)(n.li,{children:"Revise the developer-defined timer implementation."}),"\n",(0,t.jsx)(n.li,{children:"Update handling of Paywall Builder purchase events."}),"\n",(0,t.jsx)(n.li,{children:"Update handling of Paywall Builder custom action events."}),"\n",(0,t.jsxs)(n.li,{children:["Modify the ",(0,t.jsx)(n.code,{children:"onProductSelected"})," callback."]}),"\n",(0,t.jsxs)(n.li,{children:["Remove third-party integration parameters from the ",(0,t.jsx)(n.code,{children:"updateProfile"})," method."]}),"\n",(0,t.jsx)(n.li,{children:"Update integration configurations for Adjust, AirBridge, Amplitude, AppMetrica, Appsflyer, Branch, Facebook Ads, Firebase and Google Analytics, Mixpanel, OneSignal, and Pushwoosh."}),"\n",(0,t.jsx)(n.li,{children:"Update Observer mode implementation."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"upgrade-adapty-react-native-sdk-to-33x",children:"Upgrade Adapty React Native SDK to 3.3.x"}),"\n",(0,t.jsxs)(n.p,{children:["Before version 3.3.1, ",(0,t.jsx)(n.code,{children:"react-native-adapty"})," SDK served as the core and mandatory SDK for Adapty to function properly in your app. The ",(0,t.jsx)(n.code,{children:"@adapty/react-native-ui"})," SDK was optional and only needed if you were using the Adapty Paywall Builder."]}),"\n",(0,t.jsxs)(n.p,{children:["As of version 3.3.1, the ",(0,t.jsx)(n.code,{children:"@adapty/react-native-ui"})," SDK is deprecated, and its functionality has been merged into the ",(0,t.jsx)(n.code,{children:"react-native-adapty"})," SDK. To upgrade to version 3.3.1, follow these steps:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Update the ",(0,t.jsx)(n.code,{children:"react-native-adapty"})," package to version 3.3.1."]}),"\n",(0,t.jsxs)(n.li,{children:["Remove the ",(0,t.jsx)(n.code,{children:"@adapty/react-native-ui"})," package from your project dependencies."]}),"\n",(0,t.jsx)(n.li,{children:"Sync your project dependencies to apply the changes."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"changes-in-models",children:"Changes in models"}),"\n",(0,t.jsx)(n.h3,{id:"new-models",children:"New models"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://react-native.adapty.io/interfaces/adaptysubscriptionoffer",children:"AdaptySubscriptionOffer"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"export interface AdaptySubscriptionOffer {\n  readonly identifier: AdaptySubscriptionOfferId;\n\n  phases: AdaptyDiscountPhase[];\n\n  android?: {\n    offerTags?: string[];\n  };\n}\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://react-native.adapty.io/types/adaptysubscriptionofferid",children:"AdaptySubscriptionOfferId"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"export type AdaptySubscriptionOfferId =\n  | { id?: string; type: 'introductory'; }\n  | { id: string; type: 'promotional' | 'win_back'; };\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"changed-models",children:"Changed models"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://react-native.adapty.io/interfaces/adaptypaywallproduct",children:"AdaptyPaywallProduct"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Renamed the ",(0,t.jsx)(n.code,{children:"subscriptionDetails"})," property to ",(0,t.jsx)(n.code,{children:"subscription"}),"."]}),"\n",(0,t.jsx)("p",{}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:"-  subscriptionDetails?: AdaptySubscriptionDetails; \n+  subscription?: AdaptySubscriptionDetails;\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://react-native.adapty.io/interfaces/adaptysubscriptiondetails",children:"AdaptySubscriptionDetails"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"promotionalOffer"})," is removed. Now the promotional offer is delivered within the ",(0,t.jsx)(n.code,{children:"offer"})," property only if it's available. In this case ",(0,t.jsx)(n.code,{children:"offer?.identifier?.type"})," will be ",(0,t.jsx)(n.code,{children:"'promotional'"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"introductoryOfferEligibility"})," is removed (offers are returned only if the user is eligible)."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"offerId"})," is removed. Offer ID is now stored in ",(0,t.jsx)(n.code,{children:"AdaptySubscriptionOffer.identifier"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"offerTags"})," is moved to ",(0,t.jsx)(n.code,{children:"AdaptySubscriptionOffer.android"}),"."]}),"\n",(0,t.jsx)("p",{}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:"-  introductoryOffers?: AdaptyDiscountPhase[];\n+  offer?: AdaptySubscriptionOffer;\n\n   ios?: {\n-    promotionalOffer?: AdaptyDiscountPhase;\n     subscriptionGroupIdentifier?: string;\n   };\n\n   android?: {\n-    offerId?: string;\n     basePlanId: string;\n-    introductoryOfferEligibility: OfferEligibility;\n-    offerTags?: string[];\n     renewalType?: 'prepaid' | 'autorenewable';\n   };\n }\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://react-native.adapty.io/interfaces/adaptydiscountphase",children:"AdaptyDiscountPhase"}),":"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"identifier"})," field is removed from the ",(0,t.jsx)(n.code,{children:"AdaptyDiscountPhase"})," model. The offer identifier is now stored in ",(0,t.jsx)(n.code,{children:"AdaptySubscriptionOffer.identifier"}),"."]}),"\n",(0,t.jsx)("p",{}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:"-  ios?: {\n-    readonly identifier?: string;\n-  };\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"remove-models",children:"Remove models"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"AttributionSource"}),":","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The string is now used in places where ",(0,t.jsx)(n.code,{children:"AttributionSource"})," was previously used."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"OfferEligibility"}),":","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"This model has been removed as it is no longer needed. Now, an offer is returned only if the user is eligible."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.h2,{id:"remove-getproductsintroductoryoffereligibility-method",children:["Remove ",(0,t.jsx)(n.code,{children:"getProductsIntroductoryOfferEligibility"})," method"]}),"\n",(0,t.jsx)(n.p,{children:"Before Adapty SDK 3.3.1, product objects always included offers, even if the user wasn\u2019t eligible. This required you to manually check eligibility before using the offer."}),"\n",(0,t.jsx)(n.p,{children:"Starting with version 3.3.1, the product object includes offers only if the user is eligible. This simplifies the process, as you can assume the user is eligible if an offer is present."}),"\n",(0,t.jsx)(n.h2,{id:"update-making-purchase",children:"Update making purchase"}),"\n",(0,t.jsxs)(n.p,{children:["In earlier versions, canceled and pending purchases were treated as errors and returned the codes ",(0,t.jsx)(n.code,{children:"2:\xa0'paymentCancelled'"})," and ",(0,t.jsx)(n.code,{children:"25:\xa0'pendingPurchase'"}),", respectively."]}),"\n",(0,t.jsx)(n.p,{children:"Starting with version 3.3.1, canceled and pending purchases are now considered successful results and should be handled accordingly:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"try {\n    const purchaseResult = await adapty.makePurchase(product);\n    switch (purchaseResult.type) {\n      case 'success':\n        const isSubscribed = purchaseResult.profile?.accessLevels['YOUR_ACCESS_LEVEL']?.isActive;\n\n        if (isSubscribed) {\n          // Grant access to the paid features\n        }\n        break;\n      case 'user_cancelled':\n        // Handle the case where the user canceled the purchase\n        break;\n      case 'pending':\n        // Handle deferred purchases (e.g., the user will pay offline with cash)\n        break;\n    }\n} catch (error) {\n    // Handle the error\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"update-paywall-builder-paywall-presentation",children:"Update Paywall Builder paywall presentation"}),"\n",(0,t.jsxs)(n.p,{children:["For updated examples, see the ",(0,t.jsx)(n.a,{href:"react-native-present-paywalls",children:"Present new Paywall Builder paywalls in React Native"})," documentation."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:"- import { createPaywallView } from '@adapty/react-native-ui';\n+ import { createPaywallView } from 'react-native-adapty/dist/ui';\n\nconst view = await createPaywallView(paywall);\n\nview.registerEventHandlers(); // handle close press, etc\n\ntry {\n  await view.present();\n} catch (error) {\n  // handle the error\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"update-developer-defined-timer-implementation",children:"Update developer-defined timer implementation"}),"\n",(0,t.jsxs)(n.p,{children:["Rename the ",(0,t.jsx)(n.code,{children:"timerInfo"})," parameter to ",(0,t.jsx)(n.code,{children:"customTimers"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:"- let timerInfo = { 'CUSTOM_TIMER_NY': new Date(2025, 0, 1) }\n+ let customTimers = { 'CUSTOM_TIMER_NY': new Date(2025, 0, 1) }\n //and then you can pass it to createPaywallView as follows:\n- view = await createPaywallView(paywall, { timerInfo })\n+ view = await createPaywallView(paywall, { customTimers })\n"})}),"\n",(0,t.jsx)(n.h2,{id:"modify-paywall-builder-purchase-events",children:"Modify Paywall Builder purchase events"}),"\n",(0,t.jsx)(n.p,{children:"Previously:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Canceled purchases triggered the ",(0,t.jsx)(n.code,{children:"onPurchaseCancelled"})," callback."]}),"\n",(0,t.jsxs)(n.li,{children:["Pending purchases returned error code ",(0,t.jsx)(n.code,{children:"25: 'pendingPurchase'"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Now:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Both are handled by the ",(0,t.jsx)(n.code,{children:"onPurchaseCompleted"})," callback."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"steps-to-migrate",children:"Steps to migrate:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Remove the ",(0,t.jsx)(n.code,{children:"onPurchaseCancelled"})," callback."]}),"\n",(0,t.jsxs)(n.li,{children:["Remove error code handling for ",(0,t.jsx)(n.code,{children:"25: 'pendingPurchase'"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Update the ",(0,t.jsx)(n.code,{children:"onPurchaseCompleted"})," callback:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"import {createPaywallView} from 'react-native-adapty/dist/ui';\n\nconst view = await createPaywallView(paywall);\n\nconst unsubscribe = view.registerEventHandlers({\n  // ... other optional callbacks\n  onPurchaseCompleted(purchaseResult, product) {\n    switch (purchaseResult.type) {\n      case 'success':\n        const isSubscribed = purchaseResult.profile?.accessLevels['YOUR_ACCESS_LEVEL']?.isActive;\n\n        if (isSubscribed) {\n          // Grant access to the paid features\n        }\n        break;\n// highlight-start\n      case 'user_cancelled':\n        // Handle the case where the user canceled the purchase\n        break;\n      case 'pending':\n        // Handle deferred purchases (e.g., the user will pay offline with cash)\n        break;\n// highlight-end\n    }\n// highlight-start\n    return purchaseResult.type !== 'user_cancelled';\n// highlight-end\n  },\n});\n"})}),"\n",(0,t.jsx)(n.h2,{id:"modify-paywall-builder-custom-action-events",children:"Modify Paywall Builder custom action events"}),"\n",(0,t.jsx)(n.p,{children:"Removed callbacks:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"onAction"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"onCustomEvent"})}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Added callback:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["New  ",(0,t.jsx)(n.code,{children:"onCustomAction(actionId)"})," callback. Use it for custom actions."]}),"\n"]}),"\n",(0,t.jsxs)(n.h2,{id:"modify-onproductselected-callback",children:["Modify ",(0,t.jsx)(n.code,{children:"onProductSelected"})," callback"]}),"\n",(0,t.jsxs)(n.p,{children:["Previously, ",(0,t.jsx)(n.code,{children:"onProductSelected"})," required the ",(0,t.jsx)(n.code,{children:"product"})," object. Now requires ",(0,t.jsx)(n.code,{children:"productId"})," as a string."]}),"\n",(0,t.jsxs)(n.h2,{id:"remove-third-party-integration-parameters-from-updateprofile-method",children:["Remove third-party integration parameters from ",(0,t.jsx)(n.code,{children:"updateProfile"})," method"]}),"\n",(0,t.jsxs)(n.p,{children:["Third-party integration identifiers are now set using the ",(0,t.jsx)(n.code,{children:"setIntegrationIdentifier"})," method. The ",(0,t.jsx)(n.code,{children:"updateProfile"})," method no longer accepts them."]}),"\n",(0,t.jsx)(n.h2,{id:"update-third-party-integration-sdk-configuration",children:"Update third-party integration SDK configuration"}),"\n",(0,t.jsx)(n.p,{children:"To ensure integrations work properly with Adapty React Native SDK 3.3.1 and later, update your SDK configurations for the following integrations as described in the sections below."}),"\n",(0,t.jsxs)(n.p,{children:["In addition, if you used the ",(0,t.jsx)(n.code,{children:"AttributionSource"})," to get the attribution identifier, change your code to provide the required identifier as a string."]}),"\n",(0,t.jsx)(n.h3,{id:"adjust",children:"Adjust"}),"\n",(0,t.jsxs)(n.p,{children:["Update your mobile app code as shown below. For the complete code example, check out the ",(0,t.jsx)(n.a,{href:"adjust#sdk-configuration",children:"SDK configuration for Adjust integration"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:' import { Adjust, AdjustConfig } from "react-native-adjust";\n import { adapty } from "react-native-adapty";\n\n var adjustConfig = new AdjustConfig(appToken, environment);\n\n // Before submiting Adjust config...\n adjustConfig.setAttributionCallbackListener(attribution => {\n   // Make sure Adapty SDK is activated at this point\n   // You may want to lock this thread awaiting of `activate`\n   adapty.updateAttribution(attribution, "adjust");\n });\n\n // ...\n Adjust.create(adjustConfig);\n\n+ Adjust.getAdid((adid) => {\n+   if (adid)\n+     adapty.setIntegrationIdentifier("adjust_device_id", adid);\n+ });\n'})}),"\n",(0,t.jsx)(n.h3,{id:"airbridge",children:"AirBridge"}),"\n",(0,t.jsxs)(n.p,{children:["Update your mobile app code as shown below. For the complete code example, check out the ",(0,t.jsx)(n.a,{href:"airbridge#sdk-configuration",children:"SDK configuration for AirBridge integration"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:" import Airbridge from 'airbridge-react-native-sdk';\n import { adapty } from 'react-native-adapty';\n\n try {\n   const deviceId = await Airbridge.state.deviceUUID();\n\n-  await adapty.updateProfile({\n-    airbridgeDeviceId: deviceId,\n-  });\n+  await adapty.setIntegrationIdentifier(\"airbridge_device_id\", deviceId);\n } catch (error) {\n   // handle `AdaptyError`\n }\n"})}),"\n",(0,t.jsx)(n.h3,{id:"amplitude",children:"Amplitude"}),"\n",(0,t.jsxs)(n.p,{children:["Update your mobile app code as shown below. For the complete code example, check out the ",(0,t.jsx)(n.a,{href:"amplitude#sdk-configuration",children:"SDK configuration for Amplitude integration"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:'  import { adapty } from \'react-native-adapty\';\n\n try {\n-   await adapty.updateProfile({\n-     amplitudeDeviceId: deviceId,\n-     amplitudeUserId: userId,\n-   });\n+   await adapty.setIntegrationIdentifier("amplitude_device_id", deviceId);\n+   await adapty.setIntegrationIdentifier("amplitude_user_id", userId);\n } catch (error) {\n   // handle `AdaptyError`\n }\n'})}),"\n",(0,t.jsx)(n.h3,{id:"appmetrica",children:"AppMetrica"}),"\n",(0,t.jsxs)(n.p,{children:["Update your mobile app code as shown below. For the complete code example, check out the ",(0,t.jsx)(n.a,{href:"appmetrica#sdk-configuration",children:"SDK configuration for AppMetrica integration"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:" import { adapty } from 'react-native-adapty';\n import AppMetrica, { DEVICE_ID_KEY, StartupParams, StartupParamsReason } from '@appmetrica/react-native-analytics';\n\n // ...\n const startupParamsCallback = async (\n   params?: StartupParams,\n   reason?: StartupParamsReason\n ) => {\n   const deviceId = params?.deviceId\n   if (deviceId) {\n     try {\n-       await adapty.updateProfile({\n-         appmetricaProfileId: 'YOUR_ADAPTY_CUSTOMER_USER_ID',\n-         appmetricaDeviceId: deviceId,\n-       });\n+       await adapty.setIntegrationIdentifier(\"appmetrica_profile_id\", 'YOUR_ADAPTY_CUSTOMER_USER_ID');\n+       await adapty.setIntegrationIdentifier(\"appmetrica_device_id\", deviceId);\n     } catch (error) {\n       // handle `AdaptyError`\n     }\n   }\n }\n\n AppMetrica.requestStartupParams(startupParamsCallback, [DEVICE_ID_KEY])\n"})}),"\n",(0,t.jsx)(n.h3,{id:"appsflyer",children:"AppsFlyer"}),"\n",(0,t.jsxs)(n.p,{children:["Update your mobile app code as shown below. For the complete code example, check out the ",(0,t.jsx)(n.a,{href:"appsflyer#sdk-configuration",children:"SDK configuration for AppsFlyer integration"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:" import { adapty, AttributionSource } from 'react-native-adapty';\n import appsFlyer from 'react-native-appsflyer';\n\n appsFlyer.onInstallConversionData(installData => {\n     try {\n-        const networkUserId = appsFlyer.getAppsFlyerUID();\n-        adapty.updateAttribution(installData, AttributionSource.AppsFlyer, networkUserId);\n+        const uid = appsFlyer.getAppsFlyerUID();\n+        adapty.setIntegrationIdentifier(\"appsflyer_id\", uid);\n+        adapty.updateAttribution(installData, \"appsflyer\");\n     } catch (error) {\n         // handle the error\n     }\n });\n\n // ...\n appsFlyer.initSdk(/*...*/);\n"})}),"\n",(0,t.jsx)(n.h3,{id:"branch",children:"Branch"}),"\n",(0,t.jsxs)(n.p,{children:["Update your mobile app code as shown below. For the complete code example, check out the ",(0,t.jsx)(n.a,{href:"branch#sdk-configuration",children:"SDK configuration for Branch integration"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:" import { adapty, AttributionSource } from 'react-native-adapty';\n import branch from 'react-native-branch';\n\n branch.subscribe({\n   enComplete: ({\n     params,\n   }) => {\n-    adapty.updateAttribution(params, AttributionSource.Branch);\n+    adapty.updateAttribution(params, \"branch\");\n   },\n });\n"})}),"\n",(0,t.jsx)(n.h3,{id:"facebook-ads",children:"Facebook Ads"}),"\n",(0,t.jsxs)(n.p,{children:["Update your mobile app code as shown below. For the complete code example, check out the ",(0,t.jsx)(n.a,{href:"facebook-ads#sdk-configuration",children:"SDK configuration for Facebook Ads integration"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:" import { adapty } from 'react-native-adapty';\n import { AppEventsLogger } from 'react-native-fbsdk-next';\n\n try {\n   const anonymousId = await AppEventsLogger.getAnonymousID();\n\n-  await adapty.updateProfile({\n-    facebookAnonymousId: anonymousId,\n-  });\n+  await adapty.setIntegrationIdentifier(\"facebook_anonymous_id\", anonymousId);\n } catch (error) {\n   // handle `AdaptyError`\n }\n"})}),"\n",(0,t.jsx)(n.h3,{id:"firebase-and-google-analytics",children:"Firebase and Google Analytics"}),"\n",(0,t.jsxs)(n.p,{children:["Update your mobile app code as shown below. For the complete code example, check out the ",(0,t.jsx)(n.a,{href:"firebase-and-google-analytics",children:"SDK configuration for Firebase and Google Analytics integration"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:" import analytics from '@react-native-firebase/analytics';\n import { adapty } from 'react-native-adapty';\n\n try {\n   const appInstanceId = await analytics().getAppInstanceId();\n\n-   await adapty.updateProfile({\n-     firebaseAppInstanceId: appInstanceId,\n-   });\n+   await adapty.setIntegrationIdentifier(\"firebase_app_instance_id\", appInstanceId);\n } catch (error) {\n   // handle `AdaptyError`\n }\n"})}),"\n",(0,t.jsx)(n.h3,{id:"mixpanel",children:"Mixpanel"}),"\n",(0,t.jsxs)(n.p,{children:["Update your mobile app code as shown below. For the complete code example, check out the ",(0,t.jsx)(n.a,{href:"mixpanel#sdk-configuration",children:"SDK configuration for Mixpanel integration"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:" import { adapty } from 'react-native-adapty';\n import { Mixpanel } from 'mixpanel-react-native';\n\n // ...\n try {\n-   await adapty.updateProfile({\n-     mixpanelUserId: mixpanelUserId,\n-   });\n+   await adapty.setIntegrationIdentifier(\"mixpanel_user_id\", mixpanelUserId);\n } catch (error) {\n   // handle `AdaptyError`\n }\n"})}),"\n",(0,t.jsx)(n.h3,{id:"onesignal",children:"OneSignal"}),"\n",(0,t.jsxs)(n.p,{children:["Update your mobile app code as shown below. For the complete code example, check out the ",(0,t.jsx)(n.a,{href:"onesignal#sdk-configuration",children:"SDK configuration for OneSignal integration"}),"."]}),"\n",(0,t.jsxs)(r.A,{groupId:"current-os",queryString:!0,children:[(0,t.jsx)(s.A,{value:"v5+",label:"OneSignal SDK v5+ (current)",default:!0,children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:" import { adapty } from 'react-native-adapty';\n import OneSignal from 'react-native-onesignal';\n\n OneSignal.User.pushSubscription.addEventListener('change', (subscription) => {\n   const subscriptionId = subscription.current.id;\n\n   if (subscriptionId) {\n-    adapty.updateProfile({\n-      oneSignalSubscriptionId: subscriptionId,\n-    });\n+    adapty.setIntegrationIdentifier(\"one_signal_subscription_id\", subscriptionId);\n   }\n });\n"})})}),(0,t.jsx)(s.A,{value:"pre-v5",label:"OneSignal SDK v. up to 4.x (legacy)",default:!0,children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:" import { adapty } from 'react-native-adapty';\n import OneSignal from 'react-native-onesignal';\n\n OneSignal.addSubscriptionObserver(event => {\n   const playerId = event.to.userId;\n   \n-  adapty.updateProfile({\n-    oneSignalPlayerId: playerId,\n-  });\n+  adapty.setIntegrationIdentifier(\"one_signal_player_id\", playerId);\n });\n"})})})]}),"\n",(0,t.jsx)(n.h3,{id:"pushwoosh",children:"Pushwoosh"}),"\n",(0,t.jsxs)(n.p,{children:["Update your mobile app code as shown below. For the complete code example, check out the ",(0,t.jsx)(n.a,{href:"pushwoosh#sdk-configuration",children:"SDK configuration for Pushwoosh integration"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:" import { adapty } from 'react-native-adapty';\n import Pushwoosh from 'pushwoosh-react-native-plugin';\n\n // ...\n try {\n-  await adapty.updateProfile({\n-    pushwooshHWID: hwid,\n-  });\n+  await adapty.setIntegrationIdentifier(\"pushwoosh_hwid\", hwid);\n } catch (error) {\n   // handle `AdaptyError`\n }\n"})}),"\n",(0,t.jsx)(n.h2,{id:"update-observer-mode-implementation",children:"Update Observer mode implementation"}),"\n",(0,t.jsxs)(n.p,{children:["Update how you link paywalls to transactions. Previously, you used the ",(0,t.jsx)(n.code,{children:"setVariationId"})," method to assign the ",(0,t.jsx)(n.code,{children:"variationId"}),". Now, you can include the ",(0,t.jsx)(n.code,{children:"variationId"})," directly when recording the transaction using the new ",(0,t.jsx)(n.code,{children:"reportTransaction"})," method. Check out the final code example in the ",(0,t.jsx)(n.a,{href:"report-transactions-observer-mode",children:"Associate paywalls with purchase transactions in Observer mode"}),"."]}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["Don't forget to record the transaction using the ",(0,t.jsx)(n.code,{children:"reportTransaction"})," method. Skipping this step means Adapty won't recognize the transaction, won't grant access levels, won't include it in analytics, and won't send it to integrations. This step is essential!"]})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Please pay attention that the order of the parameters for the ",(0,t.jsx)(n.code,{children:"reportTransaction"})," method differs from the one for the ",(0,t.jsx)(n.code,{children:"setVariationId"})," method."]})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-diff",metastring:"showLineNumbers",children:"  const variationId = paywall.variationId;\n\n try {\n-    await adapty.setVariationId(variationId, transactionId);\n+    await adapty.reportTransaction(transactionId, variationId);\n } catch (error) {\n     // handle the `AdaptyError`\n }\n\n"})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);