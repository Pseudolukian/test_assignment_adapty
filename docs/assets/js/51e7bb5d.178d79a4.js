"use strict";(self.webpackChunkadapty_docs=self.webpackChunkadapty_docs||[]).push([[9162],{31555:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>l,toc:()=>c});var i=s(74848),r=s(28453);s(26393);const t={title:"Unity - Handle paywall events",description:"",metadataTitle:"",toc_max_heading_level:4},a=void 0,l={id:"unity-handling-events-legacy",title:"Unity - Handle paywall events",description:"",source:"@site/versioned_docs/version-3.0/unity-handling-events-legacy.md",sourceDirName:".",slug:"/unity-handling-events-legacy",permalink:"/test_assignment_adapty/docs/unity-handling-events-legacy",draft:!1,unlisted:!1,tags:[],version:"3.0",frontMatter:{title:"Unity - Handle paywall events",description:"",metadataTitle:"",toc_max_heading_level:4},sidebar:"tutorialSidebar",previous:{title:"React Native",permalink:"/test_assignment_adapty/docs/react-native-handling-events-legacy"},next:{title:"Display paywalls designed with remote config",permalink:"/test_assignment_adapty/docs/display-remote-config-paywalls"}},d={},c=[{value:"User-generated events",id:"user-generated-events",level:3},{value:"Actions",id:"actions",level:4},{value:"Product selection",id:"product-selection",level:4},{value:"Started purchase",id:"started-purchase",level:4},{value:"Canceled purchase",id:"canceled-purchase",level:4},{value:"Successful purchase",id:"successful-purchase",level:4},{value:"Failed purchase",id:"failed-purchase",level:4},{value:"Successful restore",id:"successful-restore",level:4},{value:"Failed restore",id:"failed-restore",level:4},{value:"Data fetching and rendering",id:"data-fetching-and-rendering",level:3},{value:"Product loading errors",id:"product-loading-errors",level:4},{value:"Rendering errors",id:"rendering-errors",level:4}];function o(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["Paywalls configured with the ",(0,i.jsx)(n.a,{href:"adapty-paywall-builder",children:"Paywall Builder"})," don't need extra code to make and restore purchases. However, they generate some events that your app can respond to. Those events include button presses (close buttons, URLs, product selections, and so on) as well as notifications on purchase-related actions taken on the paywall. Learn how to respond to these events below."]}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:["This guide is for ",(0,i.jsx)(n.strong,{children:"legacy Paywall Builder paywalls"}),", which require Adapty SDK up to version 2.x. The ",(0,i.jsx)(n.a,{href:"adapty-paywall-builder",children:"new Paywall Builder"})," requires Adapty SDK 3.0 or later, which is currently not available for Unity."]})}),"\n",(0,i.jsxs)(n.p,{children:["To control or monitor processes occurring on the paywall screen within your mobile app, implement the ",(0,i.jsx)(n.code,{children:"AdaptyUIEventListener"})," methods and register the observer before presenting any screen:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",metastring:'showLineNumbers title="Unity"',children:"AdaptyUI.SetEventListener(this);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"user-generated-events",children:"User-generated events"}),"\n",(0,i.jsx)(n.h4,{id:"actions",children:"Actions"}),"\n",(0,i.jsx)(n.p,{children:"If a user has performed some action, this method will be invoked:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",metastring:'showLineNumbers title="Unity"',children:"public void OnPerformAction(AdaptyUI.View view, AdaptyUI.Action action) {\n  switch (action.Type) {\n    case AdaptyUI.ActionType.Close:\n      view.Dismiss(null);\n      break;\n    case AdaptyUI.ActionType.OpenUrl:\n      var urlString = action.Value;\n      if (urlString != null {\n      \tApplication.OpenURL(urlString); \n      }\n    default:\n      // handle other events\n      break;\n  }\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"The following action types are supported:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"Close"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"OpenUrl"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.code,{children:"Custom"})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"AndroidSystemBack"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["At the very least you need to implement the reactions to both ",(0,i.jsx)(n.code,{children:"close"})," and ",(0,i.jsx)(n.code,{children:"openURL"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["For example, if a user taps the close button, the action ",(0,i.jsx)(n.code,{children:"Close"})," will occur and you are supposed to dismiss the paywall.",(0,i.jsx)(n.br,{}),"\n","Note that ",(0,i.jsx)(n.code,{children:"AdaptyUI.Action"})," has optional value property: look at this in the case of ",(0,i.jsx)(n.code,{children:"OpenUrl"})," and ",(0,i.jsx)(n.code,{children:"Custom"}),"."]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"\ud83d\udca1 Login Action"}),"\n",(0,i.jsxs)(n.p,{children:["If you have configured Login Action in the dashboard, you should implement reaction for ",(0,i.jsx)(n.code,{children:"Custom"})," action with value ",(0,i.jsx)(n.code,{children:'"login"'})]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"product-selection",children:"Product selection"}),"\n",(0,i.jsx)(n.p,{children:"If a product was selected for purchase (by a user or by the system), this method will be invoked."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",metastring:'showLineNumbers title="Unity"',children:"public void OnSelectProduct(AdaptyUI.View view, Adapty.PaywallProduct product) {\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"started-purchase",children:"Started purchase"}),"\n",(0,i.jsx)(n.p,{children:"If a user initiates the purchase process, this method will be invoked."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",metastring:'showLineNumbers title="Unity"',children:"public void OnStartPurchase(AdaptyUI.View view, Adapty.PaywallProduct product) {\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"canceled-purchase",children:"Canceled purchase"}),"\n",(0,i.jsxs)(n.p,{children:["If a user initiates the purchase process but manually interrupts it, this method will be invoked. This event occurs when the ",(0,i.jsx)(n.code,{children:"Adapty.MakePurchase()"})," function completes with a ",(0,i.jsx)(n.code,{children:".paymentCancelled"})," error:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",metastring:'showLineNumbers title="Unity"',children:"public void OnCancelPurchase(AdaptyUI.View view, Adapty.PaywallProduct product) {\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"successful-purchase",children:"Successful purchase"}),"\n",(0,i.jsxs)(n.p,{children:["If ",(0,i.jsx)(n.code,{children:"Adapty.MakePurchase()"})," succeeds, this method will be invoked:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",metastring:'showLineNumbers title="Unity"',children:"public void OnFinishPurchase(AdaptyUI.View view, \n                             Adapty.PaywallProduct product, \n                             Adapty.Profile profile) {\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"We recommend dismissing the screen in that case."}),"\n",(0,i.jsx)(n.h4,{id:"failed-purchase",children:"Failed purchase"}),"\n",(0,i.jsxs)(n.p,{children:["If ",(0,i.jsx)(n.code,{children:"Adapty.MakePurchase()"})," fails, this method will be invoked:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",metastring:'showLineNumbers title="Unity"',children:"public void OnFailPurchase(AdaptyUI.View view, \n                           Adapty.PaywallProduct product, \n                           Adapty.Error error) {\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"successful-restore",children:"Successful restore"}),"\n",(0,i.jsxs)(n.p,{children:["If ",(0,i.jsx)(n.code,{children:"Adapty.RestorePurchases()"})," succeeds, this method will be invoked:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",metastring:'showLineNumbers title="Unity"',children:"public void OnFinishRestore(AdaptyUI.View view, Adapty.Profile profile) {\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["We recommend dismissing the screen if the user has the required ",(0,i.jsx)(n.code,{children:"accessLevel"}),". Refer to the ",(0,i.jsx)(n.a,{href:"subscription-status",children:"Subscription status"})," topic to learn how to check it."]}),"\n",(0,i.jsx)(n.h4,{id:"failed-restore",children:"Failed restore"}),"\n",(0,i.jsxs)(n.p,{children:["If ",(0,i.jsx)(n.code,{children:"Adapty.RestorePurchases()"})," fails, this method will be invoked:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",metastring:'showLineNumbers title="Unity"',children:"public void OnFailRestore(AdaptyUI.View view, Adapty.Error error) {\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"data-fetching-and-rendering",children:"Data fetching and rendering"}),"\n",(0,i.jsx)(n.h4,{id:"product-loading-errors",children:"Product loading errors"}),"\n",(0,i.jsx)(n.p,{children:"If you didn't pass the product array during initialization, AdaptyUI will retrieve the necessary objects from the server by itself. In this case, this operation may fail, and AdaptyUI will report the error by invoking this method:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",metastring:'showLineNumbers title="Unity"',children:"public void OnFailLoadingProducts(AdaptyUI.View view, Adapty.Error error) {\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"rendering-errors",children:"Rendering errors"}),"\n",(0,i.jsx)(n.p,{children:"If an error occurs during the interface rendering, it will be reported by calling this method:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",metastring:'showLineNumbers title="Unity"',children:"public void OnFailRendering(AdaptyUI.View view, Adapty.Error error) {\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"In a normal situation, such errors should not occur, so if you come across one, please let us know."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);