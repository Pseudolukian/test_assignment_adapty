"use strict";(self.webpackChunkadapty_docs=self.webpackChunkadapty_docs||[]).push([[424],{59958:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var i=n(74848),t=n(28453);n(26393);const s={title:"Flutter - Handle paywall events",description:"Handle subscription events in Flutter (Legacy) with Adapty\u2019s SDK.",metadataTitle:"Handling Events in Flutter (Legacy) | Adapty Docs"},a=void 0,l={id:"flutter-handling-events-legacy",title:"Flutter - Handle paywall events",description:"Handle subscription events in Flutter (Legacy) with Adapty\u2019s SDK.",source:"@site/versioned_docs/version-3.0/flutter-handling-events-legacy.md",sourceDirName:".",slug:"/flutter-handling-events-legacy",permalink:"/docs/flutter-handling-events-legacy",draft:!1,unlisted:!1,tags:[],version:"3.0",frontMatter:{title:"Flutter - Handle paywall events",description:"Handle subscription events in Flutter (Legacy) with Adapty\u2019s SDK.",metadataTitle:"Handling Events in Flutter (Legacy) | Adapty Docs"},sidebar:"tutorialSidebar",previous:{title:"Android",permalink:"/docs/android-handling-events-legacy"},next:{title:"React Native",permalink:"/docs/react-native-handling-events-legacy"}},d={},c=[{value:"User-generated events",id:"user-generated-events",level:3},{value:"Actions",id:"actions",level:4},{value:"Product selection",id:"product-selection",level:4},{value:"Started purchase",id:"started-purchase",level:4},{value:"Canceled purchase",id:"canceled-purchase",level:4},{value:"Successful purchase",id:"successful-purchase",level:4},{value:"Failed purchase",id:"failed-purchase",level:4},{value:"Successful restore",id:"successful-restore",level:4},{value:"Failed restore",id:"failed-restore",level:4},{value:"Data fetching and rendering",id:"data-fetching-and-rendering",level:3},{value:"Product loading errors",id:"product-loading-errors",level:4},{value:"Rendering errors",id:"rendering-errors",level:4}];function o(e){const r={a:"a",admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(r.p,{children:["Paywalls configured with the ",(0,i.jsx)(r.a,{href:"adapty-paywall-builder",children:"Paywall Builder"})," don't need extra code to make and restore purchases. However, they generate some events that your app can respond to. Those events include button presses (close buttons, URLs, product selections, and so on) as well as notifications on purchase-related actions taken on the paywall. Learn how to respond to these events below."]}),"\n",(0,i.jsx)(r.admonition,{type:"warning",children:(0,i.jsxs)(r.p,{children:["This guide is for ",(0,i.jsx)(r.strong,{children:"legacy Paywall Builder paywalls"})," only which require Adapty SDK up to v2.x. For presenting paywalls in Adapty SDK v3.0 or later designed with the new Paywall Builder, see ",(0,i.jsx)(r.a,{href:"flutter-handling-events",children:"Flutter - Handle paywall events designed with the new Paywall Builder"}),"."]})}),"\n",(0,i.jsxs)(r.p,{children:["To control or monitor processes occurring on the paywall screen within your mobile app, implement the ",(0,i.jsx)(r.code,{children:"AdaptyUIObserver"})," methods and register the observer before presenting any screen:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",metastring:'showLineNumbers title="Flutter"',children:"AdaptyUI().addObserver(this);\n"})}),"\n",(0,i.jsx)(r.h3,{id:"user-generated-events",children:"User-generated events"}),"\n",(0,i.jsx)(r.h4,{id:"actions",children:"Actions"}),"\n",(0,i.jsxs)(r.p,{children:["If a user has performed some action (",(0,i.jsx)(r.code,{children:"close"}),", ",(0,i.jsx)(r.code,{children:"openURL"}),", ",(0,i.jsx)(r.code,{children:"androidSystemBack"}),", or ",(0,i.jsx)(r.code,{children:"custom"}),", this method will be invoked:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",metastring:'showLineNumbers title="Flutter"',children:"// You have to install url_launcher plugin in order to handle urls:\n// https://pub.dev/packages/url_launcher\nimport 'package:url_launcher/url_launcher_string.dart'; \n\nvoid paywallViewDidPerformAction(AdaptyUIView view, AdaptyUIAction action) {\n  switch (action.type) {\n    case AdaptyUIActionType.close:\n      view.dismiss();\n      break;\n    case AdaptyUIActionType.openUrl:\n      final urlString = action.value;\n      if (urlString != null) {\n          launchUrlString(urlString);\n      }\n    default:\n      break;\n  }\n}\n"})}),"\n",(0,i.jsx)(r.p,{children:"The following action types are supported:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.code,{children:"close"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.code,{children:"openUrl"})}),"\n",(0,i.jsx)(r.li,{children:(0,i.jsx)(r.code,{children:"custom"})}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.code,{children:"androidSystemBack"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:["Note that at the very least you need to implement the reactions to both ",(0,i.jsx)(r.code,{children:"close"})," and ",(0,i.jsx)(r.code,{children:"openURL"}),"."]}),"\n",(0,i.jsxs)(r.p,{children:["For example, if a user taps the close button, the action ",(0,i.jsx)(r.code,{children:"close"})," will occur and you are supposed to dismiss the paywall. Refer to the ",(0,i.jsx)(r.a,{href:"hide-paywall-builder-paywalls",children:"Hide Paywall Builder paywalls"})," topic for details on dismissing a paywall screen.",(0,i.jsx)(r.br,{}),"\n","Note that ",(0,i.jsx)(r.code,{children:"AdaptyUIAction"})," has optional value property: look at this in the case of ",(0,i.jsx)(r.code,{children:"openUrl"})," and ",(0,i.jsx)(r.code,{children:"custom"}),"."]}),"\n",(0,i.jsxs)(r.blockquote,{children:["\n",(0,i.jsx)(r.p,{children:"\ud83d\udca1 Login Action"}),"\n",(0,i.jsxs)(r.p,{children:["If you have configured Login Action in the dashboard, you should implement reaction for ",(0,i.jsx)(r.code,{children:"custom"})," action with value ",(0,i.jsx)(r.code,{children:'"login"'})]}),"\n"]}),"\n",(0,i.jsx)(r.h4,{id:"product-selection",children:"Product selection"}),"\n",(0,i.jsx)(r.p,{children:"If a product is selected for purchase (by a user or by the system), this method will be invoked:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",metastring:'showLineNumbers title="Flutter"',children:"void paywallViewDidSelectProduct(AdaptyUIView view, AdaptyPaywallProduct product) {\n}\n"})}),"\n",(0,i.jsx)(r.h4,{id:"started-purchase",children:"Started purchase"}),"\n",(0,i.jsx)(r.p,{children:"If a user initiates the purchase process, this method will be invoked:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",metastring:'showLineNumbers title="Flutter"',children:"void paywallViewDidStartPurchase(AdaptyUIView view, AdaptyPaywallProduct product) {\n}\n"})}),"\n",(0,i.jsx)(r.h4,{id:"canceled-purchase",children:"Canceled purchase"}),"\n",(0,i.jsxs)(r.p,{children:["If a user initiates the purchase process but manually interrupts it, the function below will be invoked. Basically, this event occurs when the ",(0,i.jsx)(r.code,{children:"Adapty.makePurchase()"})," function completes with the ",(0,i.jsx)(r.code,{children:".paymentCancelled"})," error:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",metastring:'showLineNumbers title="Flutter"',children:"void paywallViewDidCancelPurchase(AdaptyUIView view, AdaptyPaywallProduct product) {\n}\n"})}),"\n",(0,i.jsx)(r.h4,{id:"successful-purchase",children:"Successful purchase"}),"\n",(0,i.jsxs)(r.p,{children:["If ",(0,i.jsx)(r.code,{children:"Adapty.makePurchase()"})," succeeds, this method will be invoked:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",metastring:'showLineNumbers title="Flutter"',children:"void paywallViewDidFinishPurchase(AdaptyUIView view, \n                                  AdaptyPaywallProduct product, \n                                  AdaptyProfile profile) {\n}\n"})}),"\n",(0,i.jsxs)(r.p,{children:["We recommend dismissing the screen in that case. Refer to the ",(0,i.jsx)(r.a,{href:"hide-paywall-builder-paywalls",children:"Hide Paywall Builder paywalls"})," for details on dismissing a paywall screen."]}),"\n",(0,i.jsx)(r.h4,{id:"failed-purchase",children:"Failed purchase"}),"\n",(0,i.jsxs)(r.p,{children:["If ",(0,i.jsx)(r.code,{children:"Adapty.makePurchase()"})," fails, this method will be invoked:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",metastring:'showLineNumbers title="Flutter"',children:"void paywallViewDidFailPurchase(AdaptyUIView view, \n                                AdaptyPaywallProduct product, \n                                AdaptyError error) {\n}\n"})}),"\n",(0,i.jsx)(r.h4,{id:"successful-restore",children:"Successful restore"}),"\n",(0,i.jsxs)(r.p,{children:["If ",(0,i.jsx)(r.code,{children:"Adapty.restorePurchases()"})," succeeds, this method will be invoked:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",metastring:'showLineNumbers title="Flutter"',children:"void paywallViewDidFinishRestore(AdaptyUIView view, AdaptyProfile profile) {\n}\n"})}),"\n",(0,i.jsxs)(r.p,{children:["We recommend dismissing the screen if the user has the required ",(0,i.jsx)(r.code,{children:"accessLevel"}),". Refer to the ",(0,i.jsx)(r.a,{href:"subscription-status",children:"Subscription status"})," topic to learn how to check it and to ",(0,i.jsx)(r.a,{href:"hide-paywall-builder-paywalls",children:"Hide Paywall Builder paywalls"})," topic to learn how to dismiss a paywall screen."]}),"\n",(0,i.jsx)(r.h4,{id:"failed-restore",children:"Failed restore"}),"\n",(0,i.jsxs)(r.p,{children:["If ",(0,i.jsx)(r.code,{children:"Adapty.restorePurchases()"})," fails, this method will be invoked:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",metastring:'showLineNumbers title="Flutter"',children:"void paywallViewDidFailRestore(AdaptyUIView view, AdaptyError error) {\n}\n"})}),"\n",(0,i.jsx)(r.h3,{id:"data-fetching-and-rendering",children:"Data fetching and rendering"}),"\n",(0,i.jsx)(r.h4,{id:"product-loading-errors",children:"Product loading errors"}),"\n",(0,i.jsx)(r.p,{children:"If you don't pass the product array during the initialization, AdaptyUI will retrieve the necessary objects from the server by itself. If this operation fails, AdaptyUI will report the error by invoking this method:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",metastring:'showLineNumbers title="Flutter"',children:"void paywallViewDidFailLoadingProducts(AdaptyUIView view, AdaptyIOSProductsFetchPolicy? fetchPolicy, AdaptyError error) {\n}\n"})}),"\n",(0,i.jsx)(r.h4,{id:"rendering-errors",children:"Rendering errors"}),"\n",(0,i.jsx)(r.p,{children:"If an error occurs during the interface rendering, it will be reported by calling this method:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-javascript",metastring:'showLineNumbers title="Flutter"',children:"void paywallViewDidFailRendering(AdaptyUIView view, AdaptyError error) {\n}\n"})}),"\n",(0,i.jsx)(r.p,{children:"In a normal situation, such errors should not occur, so if you come across one, please let us know."})]})}function h(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}}}]);