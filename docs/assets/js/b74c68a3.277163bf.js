"use strict";(self.webpackChunkadapty_docs=self.webpackChunkadapty_docs||[]).push([[1699],{2673:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/onesignal-id-d566f44c6f0f6d182b2acc64b1394006.webp"},11470:(e,n,t)=>{t.d(n,{A:()=>S});var i=t(96540),s=t(34164),r=t(23104),a=t(56347),l=t(205),o=t(57485),d=t(31682),c=t(70679);function u(e){return i.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,i.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,i.useMemo)((()=>{const e=n??function(e){return u(e).map((e=>{let{props:{value:n,label:t,attributes:i,default:s}}=e;return{value:n,label:t,attributes:i,default:s}}))}(t);return function(e){const n=(0,d.X)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function p(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function g(e){let{queryString:n=!1,groupId:t}=e;const s=(0,a.W6)(),r=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,o.aZ)(r),(0,i.useCallback)((e=>{if(!r)return;const n=new URLSearchParams(s.location.search);n.set(r,e),s.replace({...s.location,search:n.toString()})}),[r,s])]}function x(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,r=h(e),[a,o]=(0,i.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!p({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const i=t.find((e=>e.default))??t[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:n,tabValues:r}))),[d,u]=g({queryString:t,groupId:s}),[x,j]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[s,r]=(0,c.Dv)(t);return[s,(0,i.useCallback)((e=>{t&&r.set(e)}),[t,r])]}({groupId:s}),b=(()=>{const e=d??x;return p({value:e,tabValues:r})?e:null})();(0,l.A)((()=>{b&&o(b)}),[b]);return{selectedValue:a,selectValue:(0,i.useCallback)((e=>{if(!p({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),j(e)}),[u,j,r]),tabValues:r}}var j=t(92303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var m=t(74848);function f(e){let{className:n,block:t,selectedValue:i,selectValue:a,tabValues:l}=e;const o=[],{blockElementScrollPositionUntilNextRender:d}=(0,r.a_)(),c=e=>{const n=e.currentTarget,t=o.indexOf(n),s=l[t].value;s!==i&&(d(n),a(s))},u=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1];break}}n?.focus()};return(0,m.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":t},n),children:l.map((e=>{let{value:n,label:t,attributes:r}=e;return(0,m.jsx)("li",{role:"tab",tabIndex:i===n?0:-1,"aria-selected":i===n,ref:e=>o.push(e),onKeyDown:u,onClick:c,...r,className:(0,s.A)("tabs__item",b.tabItem,r?.className,{"tabs__item--active":i===n}),children:t??n},n)}))})}function y(e){let{lazy:n,children:t,selectedValue:s}=e;const r=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=r.find((e=>e.props.value===s));return e?(0,i.cloneElement)(e,{className:"margin-top--md"}):null}return(0,m.jsx)("div",{className:"margin-top--md",children:r.map(((e,n)=>(0,i.cloneElement)(e,{key:n,hidden:e.props.value!==s})))})}function v(e){const n=x(e);return(0,m.jsxs)("div",{className:(0,s.A)("tabs-container",b.tabList),children:[(0,m.jsx)(f,{...n,...e}),(0,m.jsx)(y,{...n,...e})]})}function S(e){const n=(0,j.A)();return(0,m.jsx)(v,{...e,children:u(e.children)},String(n))}},19261:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/onesignal-on-daedfbecc827ca4cdae4a28c2047fe16.webp"},19365:(e,n,t)=>{t.d(n,{A:()=>a});t(96540);var i=t(34164);const s={tabItem:"tabItem_Ymn6"};var r=t(74848);function a(e){let{children:n,hidden:t,className:a}=e;return(0,r.jsx)("div",{role:"tabpanel",className:(0,i.A)(s.tabItem,a),hidden:t,children:n})}},33452:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/onesignal-dashboard-cb76926dec788080fe97635c72a6f963.webp"},66313:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/onesignal-6d37795468d3aee60186266b343d0302.webp"},93114:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>d,default:()=>g,frontMatter:()=>o,metadata:()=>c,toc:()=>h});var i=t(74848),s=t(28453),r=t(34028),a=(t(26393),t(11470)),l=t(19365);const o={title:"OneSignal",description:"Integrate OneSignal with Adapty to improve push notification-based engagement.",metadataTitle:"OneSignal Integration Guide | Adapty Docs"},d=void 0,c={id:"onesignal",title:"OneSignal",description:"Integrate OneSignal with Adapty to improve push notification-based engagement.",source:"@site/versioned_docs/version-3.0/onesignal.md",sourceDirName:".",slug:"/onesignal",permalink:"/test_assignment_adapty/docs/onesignal",draft:!1,unlisted:!1,tags:[],version:"3.0",frontMatter:{title:"OneSignal",description:"Integrate OneSignal with Adapty to improve push notification-based engagement.",metadataTitle:"OneSignal Integration Guide | Adapty Docs"},sidebar:"tutorialSidebar",previous:{title:"Braze",permalink:"/test_assignment_adapty/docs/braze"},next:{title:"Pushwoosh",permalink:"/test_assignment_adapty/docs/pushwoosh"}},u={},h=[{value:"Setting up One Signal integration",id:"setting-up-one-signal-integration",level:2},{value:"Retrieving your OneSignal App ID",id:"retrieving-your-onesignal-app-id",level:2},{value:"Configuring events",id:"configuring-events",level:3},{value:"Custom tags",id:"custom-tags",level:2},{value:"SDK configuration",id:"sdk-configuration",level:3},{value:"Dealing with multiple devices",id:"dealing-with-multiple-devices",level:2}];function p(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"https://onesignal.com/",children:"OneSignal"})," is a leading customer engagement platform offering push notifications, email, SMS, and in-app messaging. Integrating Adapty with OneSignal enables you to access all your subscription events in one place, allowing you to trigger automated communication based on those events."]}),"\n",(0,i.jsxs)(n.p,{children:["With Adapty, you can track ",(0,i.jsx)(n.a,{href:"events",children:"subscription events"})," across multiple stores, analyze user behavior, and use that data for more targeted communication. This integration helps you monitor subscription events within your OneSignal dashboard and map them to your ",(0,i.jsx)(n.a,{href:"https://documentation.onesignal.com/docs/automated-messages#example-automated-message-campaigns",children:"acquisition campaigns"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Adapty updates OneSignal tags based on subscription events, enabling you to deliver personalized push notifications with minimal setup."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Integration characteristics"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Integration characteristic"}),(0,i.jsx)(n.th,{style:{textAlign:"left"},children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Schedule"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Real-time updates"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Data direction"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"One-way: from Adapty to OneSignal server"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"left"},children:"Adapty integration point"}),(0,i.jsx)(n.td,{style:{textAlign:"left"},children:(0,i.jsxs)("ul",{children:[(0,i.jsx)("li",{children:"OneSignal and Adapty SDKs in the mobile app code"}),(0,i.jsx)("li",{children:"Adapty server"})]})})]})]})]}),"\n",(0,i.jsx)(n.h2,{id:"setting-up-one-signal-integration",children:"Setting up One Signal integration"}),"\n",(0,i.jsx)(n.p,{children:"To set up the integration:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Open ",(0,i.jsx)(n.a,{href:"https://app.adapty.io/integrations/onesignal",children:"Integrations \u2192 OneSignal"})," in your Adapty Dashboard."]}),"\n",(0,i.jsx)(r.A,{children:(0,i.jsx)("img",{src:t(19261).A,style:{border:"1px solid #727272",width:"700px",display:"block",margin:"0 auto"}})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Enable the integration toggle."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Enter your ",(0,i.jsx)(n.strong,{children:"OneSignal App ID"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["To set up the integration with OneSignal, go to ",(0,i.jsx)(n.a,{href:"https://app.adapty.io/integrations/onesignal",children:"Integrations -> OneSignal"})," in your Adapty dashboard, turn on a toggle, and configure the integration credentials."]}),"\n",(0,i.jsx)(n.h2,{id:"retrieving-your-onesignal-app-id",children:"Retrieving your OneSignal App ID"}),"\n",(0,i.jsxs)(n.p,{children:["Find your ",(0,i.jsx)(n.strong,{children:"OneSignal App ID"})," in your ",(0,i.jsx)(n.a,{href:"https://dashboard.onesignal.com/login",children:"OneSignal Dashboard"}),":"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Navigate to ",(0,i.jsx)(n.strong,{children:"Settings"})," \u2192 ",(0,i.jsx)(n.strong,{children:"Keys & IDs"}),"."]}),"\n",(0,i.jsx)(r.A,{children:(0,i.jsx)("img",{src:t(33452).A,style:{border:"1px solid #727272",width:"700px",display:"block",margin:"0 auto"}})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Copy your ",(0,i.jsx)(n.strong,{children:"OneSignal App ID"})," and paste it into the ",(0,i.jsx)(n.strong,{children:"App ID"})," field in the Adapty Dashboard."]}),"\n",(0,i.jsx)(r.A,{children:(0,i.jsx)("img",{src:t(2673).A,style:{border:"1px solid #727272",width:"700px",display:"block",margin:"0 auto"}})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["You can find more information about the OneSignal ID in the ",(0,i.jsx)(n.a,{href:"https://documentation.onesignal.com/docs/keys-and-ids",children:"following documentation."})]}),"\n",(0,i.jsx)(n.h3,{id:"configuring-events",children:"Configuring events"}),"\n",(0,i.jsxs)(n.p,{children:["Adapty allows you to send three groups of events to OneSignal. Toggle on the ones you need in the Adapty Dashboard. You can view the complete list of available events with detailed description ",(0,i.jsx)(n.a,{href:"events",children:"here"}),"."]}),"\n",(0,i.jsx)(r.A,{children:(0,i.jsx)("img",{src:t(66313).A,style:{border:"1px solid #727272",width:"700px",display:"block",margin:"0 auto"}})}),"\n",(0,i.jsx)(n.p,{children:"Adapty sends subscription events to OneSignal using a server-to-server integration, allowing you to track all subscription-related activity in OneSignal."}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:["Starting April 17, 2023, OneSignal's Free Plan no longer supports this integration. It is available only on ",(0,i.jsx)(n.strong,{children:"Growth"}),", ",(0,i.jsx)(n.strong,{children:"Professional"}),", and ",(0,i.jsx)(n.strong,{children:"higher"})," plans. For details, see ",(0,i.jsx)(n.a,{href:"https://onesignal.com/pricing",children:"OneSignal Pricing"}),"."]})}),"\n",(0,i.jsx)(n.h2,{id:"custom-tags",children:"Custom tags"}),"\n",(0,i.jsx)(n.p,{children:"This integration updates and assigns various properties to your Adapty users as tags, which are then sent to OneSignal. Refer to the list of tags below to find the ones that best fit your needs."}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:"OneSignal has a tag limit. This includes both Adapty-generated tags and any existing tags in OneSignal. Exceeding the limit may cause errors when sending events."})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Tag"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"adapty_customer_user_id"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsx)(n.td,{children:"The unique identifier of the user in your app. It must be consistent across your system, Adapty, and OneSignal."})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"adapty_profile_id"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsxs)(n.td,{children:["The Adapty user profile ID, available in your ",(0,i.jsx)(n.a,{href:"profiles-crm",children:"Adapty Dashboard"}),"."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"environment"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"Sandbox"})," or ",(0,i.jsx)(n.code,{children:"Production"}),", indicating the user\u2019s current environment."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"store"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsxs)(n.td,{children:["Store where the product was bought. Options: ",(0,i.jsx)(n.strong,{children:"app_store"}),", ",(0,i.jsx)(n.strong,{children:"play_store"}),", ",(0,i.jsx)(n.strong,{children:"stripe"}),", or the name of your ",(0,i.jsx)(n.a,{href:"custom-store",children:"custom store"}),"."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"vendor_product_id"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsxs)(n.td,{children:["The product ID in the app store (e.g., ",(0,i.jsx)(n.code,{children:"org.locals.12345"}),")."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"subscription_expires_at"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsxs)(n.td,{children:["Expiration date of the latest subscription (",(0,i.jsx)(n.code,{children:"YYYY-MM-DDTHH:MM:SS+0000"}),", e.g., ",(0,i.jsx)(n.code,{children:"2023-02-10T17:22:03.000000+0000"}),")."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"last_event_type"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsxs)(n.td,{children:["The latest event type from the ",(0,i.jsx)(n.a,{href:"events",children:"Adapty event list"}),"."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"purchase_date"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsxs)(n.td,{children:["Last transaction date (",(0,i.jsx)(n.code,{children:"YYYY-MM-DDTHH:MM:SS+0000"}),", e.g., ",(0,i.jsx)(n.code,{children:"2023-02-10T17:22:03.000000+0000"}),")."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"active_subscription"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"true"})," if the user has an active subscription and ",(0,i.jsx)(n.code,{children:"false"})," if the subscription has expired."]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"period_type"})}),(0,i.jsx)(n.td,{children:"String"}),(0,i.jsxs)(n.td,{children:["Indicates the most recent period type for the purchase or renewal. Possible values: ",(0,i.jsx)(n.code,{children:"trial"})," for a trial period or ",(0,i.jsx)(n.code,{children:"normal"})," for all other cases."]})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"All float values are rounded to integers. The strings remain unchanged."}),"\n",(0,i.jsxs)(n.p,{children:["In addition to the predefined tags, you can send ",(0,i.jsx)(n.a,{href:"segments#custom-attributes",children:"custom attributes"})," as tags, providing greater flexibility in the data you include. This is useful for tracking specific details related to your product or service."]}),"\n",(0,i.jsxs)(n.p,{children:["Custom user attributes are automatically sent to OneSignal if the ",(0,i.jsx)(n.strong,{children:"Send user attributes"})," checkbox is enabled on the ",(0,i.jsx)(n.a,{href:"https://app.adapty.io/integrations/onesignal",children:"integration page"}),". When unchecked, Adapty sends exactly 10 tags. If checked, more than 10 tags can be sent, allowing for enhanced data capture."]}),"\n",(0,i.jsx)(n.h3,{id:"sdk-configuration",children:"SDK configuration"}),"\n",(0,i.jsx)(n.p,{children:"There are two ways to integrate OneSignal with Adapty:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Legacy (pre-v5):"})," Uses ",(0,i.jsx)(n.code,{children:"playerId"})," (deprecated in ",(0,i.jsx)(n.a,{href:"https://github.com/OneSignal/OneSignal-iOS-SDK/releases/tag/5.0.0",children:"OneSignal SDK v5"}),")."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Current (v5+):"})," Uses ",(0,i.jsx)(n.code,{children:"subscriptionId"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:["Make sure to send ",(0,i.jsx)(n.code,{children:"playerId"})," (for OneSignal SDK pre-v5) or ",(0,i.jsx)(n.code,{children:"subscriptionId"})," (for OneSignal SDK v5+) to Adapty. Without this, OneSignal tags won\u2019t be updated, and the integration won\u2019t function properly."]})}),"\n",(0,i.jsxs)(a.A,{groupId:"current-version",queryString:!0,children:[(0,i.jsx)(l.A,{value:"v5+",label:"OneSignal SDK v5+ (current)",default:!0,children:(0,i.jsxs)(a.A,{groupId:"current-os",queryString:!0,children:[(0,i.jsx)(l.A,{value:"swift",label:"iOS (Swift)",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-swift",metastring:"showLineNumbers",children:'// SubscriptionID\nOneSignal.Notifications.requestPermission({ accepted in\n    Task {\n        try await Adapty.setIntegrationIdentifier(\n            key: "one_signal_subscription_id", \n            value: OneSignal.User.pushSubscription.id\n        )\n    }\n}, fallbackToSettings: true)\n'})})}),(0,i.jsx)(l.A,{value:"kotlin",label:"Android (Kotlin)",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",metastring:"showLineNumbers",children:'// SubscriptionID\nval oneSignalSubscriptionObserver = object: IPushSubscriptionObserver {\n    override fun onPushSubscriptionChange(state: PushSubscriptionChangedState) {\n        Adapty.setIntegrationIdentifier("one_signal_subscription_id", state.current.id) { error ->\n            if (error != null) {\n                // handle the error\n            }\n        }\n    }\n}\n'})})}),(0,i.jsx)(l.A,{value:"java",label:"(Android) Java",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:"showLineNumbers",children:'// SubscriptionID\nIPushSubscriptionObserver oneSignalSubscriptionObserver = state -> {\n    Adapty.setIntegrationIdentifier("one_signal_subscription_id", state.getCurrent().getId(), error -> {\n        if (error != null) {\n            // handle the error\n        }\n    });\n};\n'})})}),(0,i.jsx)(l.A,{value:"flutter",label:"Flutter (Dart)",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",metastring:"showLineNumbers",children:"OneSignal.shared.setSubscriptionObserver((changes) {\n    final playerId = changes.to.userId;\n    if (playerId != null) {\n        final builder = \n            AdaptyProfileParametersBuilder()\n                ..setOneSignalPlayerId(playerId);\n                // ..setOneSignalSubscriptionId(playerId);\n        try {\n            Adapty().updateProfile(builder.build());\n        } on AdaptyError catch (adaptyError) {\n            // handle the error\n        } catch (e) {\n            // handle the error\n        }\n    }\n});\n"})})}),(0,i.jsx)(l.A,{value:"unity",label:"Unity (C#)",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-csharp",metastring:"showLineNumbers",children:'using AdaptySDK;\nusing OneSignalSDK;\n\nvar pushUserId = OneSignal.Default.PushSubscriptionState.userId;\n\nAdapty.SetIntegrationIdentifier(\n  "one_signal_player_id", \n  pushUserId, \n  (error) => {\n  // handle the error\n});\n'})})}),(0,i.jsx)(l.A,{value:"rn",label:"React Native (TS)",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"import { adapty } from 'react-native-adapty';\nimport OneSignal from 'react-native-onesignal';\n\nOneSignal.User.pushSubscription.addEventListener('change', (subscription) => {\n  const subscriptionId = subscription.current.id;\n\n  if (subscriptionId) {\n    adapty.setIntegrationIdentifier(\"one_signal_subscription_id\", subscriptionId);\n  }\n});\n"})})})]})}),(0,i.jsx)(l.A,{value:"pre-v5",label:"OneSignal SDK v. up to 4.x (legacy)",default:!0,children:(0,i.jsxs)(a.A,{groupId:"current-os",queryString:!0,children:[(0,i.jsx)(l.A,{value:"swift",label:"iOS (Swift)",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-swift",metastring:"showLineNumbers",children:'// PlayerID\n// in your OSSubscriptionObserver implementation\nfunc onOSSubscriptionChanged(_ stateChanges: OSSubscriptionStateChanges) {\n    if let playerId = stateChanges.to.userId {\n        Task {\n            try await Adapty.setIntegrationIdentifier(\n                key: "one_signal_player_id", \n                value: playerId\n            )\n        }\n    }\n}\n'})})}),(0,i.jsx)(l.A,{value:"kotlin",label:"Android (Kotlin)",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-kotlin",metastring:"showLineNumbers",children:'// PlayerID\nval osSubscriptionObserver = OSSubscriptionObserver { stateChanges ->\n    stateChanges?.to?.userId?.let { playerId ->\n        Adapty.setIntegrationIdentifier("one_signal_player_id", playerId) { error ->\n            if (error != null) {\n                // handle the error\n            }\n        }\n    }\n}\n'})})}),(0,i.jsx)(l.A,{value:"java",label:"Java",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",metastring:"showLineNumbers",children:'// PlayerID\nOSSubscriptionObserver osSubscriptionObserver = stateChanges -> {\n    OSSubscriptionState to = stateChanges != null ? stateChanges.getTo() : null;\n    String playerId = to != null ? to.getUserId() : null;\n    \n    if (playerId != null) {\n        Adapty.setIntegrationIdentifier("one_signal_player_id", playerId, error -> {\n            if (error != null) {\n                // handle the error\n            }\n        });\n    }\n};\n'})})}),(0,i.jsx)(l.A,{value:"flutter",label:"Flutter (Dart)",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",metastring:"showLineNumbers",children:'// PlayerID (pre-v5 OneSignal SDK)\n// in your OSSubscriptionObserver implementation\nfunc onOSSubscriptionChanged(_ stateChanges: OSSubscriptionStateChanges) {\n    if let playerId = stateChanges.to.userId {\n        Task {\n            try await Adapty.setIntegrationIdentifier(\n                key: "one_signal_player_id", \n                value: playerId\n            )\n        }\n    }\n}\n'})})}),(0,i.jsx)(l.A,{value:"rn",label:"React Native (TS)",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:"showLineNumbers",children:"import { adapty } from 'react-native-adapty';\nimport OneSignal from 'react-native-onesignal';\n\nOneSignal.addSubscriptionObserver(event => {\n  const playerId = event.to.userId;\n  \n  adapty.setIntegrationIdentifier(\"one_signal_player_id\", playerId);\n});\n"})})})]})})]}),"\n",(0,i.jsxs)(n.p,{children:["Read more about ",(0,i.jsx)(n.code,{children:"OSSubscriptionObserver"})," in the ",(0,i.jsx)(n.a,{href:"https://documentation.onesignal.com/docs/sdk-reference#handling-subscription-state-changes",children:"OneSignal documentation"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"dealing-with-multiple-devices",children:"Dealing with multiple devices"}),"\n",(0,i.jsxs)(n.p,{children:["If a user has multiple devices, tracking purchase events and subscriptions can be challenging. OneSignal provides a way to handle this through ",(0,i.jsx)(n.a,{href:"https://documentation.onesignal.com/docs/external-user-ids",children:"external user IDs"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"To keep user data consistent across devices:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Match different devices on your ",(0,i.jsx)(n.strong,{children:"server side"})," and send this data to OneSignal."]}),"\n",(0,i.jsxs)(n.li,{children:["Use Adapty\u2019s ",(0,i.jsx)(n.a,{href:"identifying-users",children:"customer_user_id"})," as an ",(0,i.jsx)(n.a,{href:"https://documentation.onesignal.com/docs/external-user-ids#setexternaluserid-method",children:"externalUserId"})," in OneSignal. If your app doesn't have a registration system, consider using another unique identifier that remains consistent across the user's devices."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["It's important to maintain consistency in the user identifier across all devices and update OneSignal whenever a user's ID changes. This simplifies tracking user activity and subscriptions while ensuring consistent messaging and allows for more accurate analytics and a better user experience. For more details, see OneSignal's ",(0,i.jsx)(n.a,{href:"https://documentation.onesignal.com/docs/external-user-ids",children:"external user ID documentation"}),"."]})]})}function g(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}}}]);